

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>nutsml package &mdash; nutsml 1.0.38 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="nutsml.examples package" href="nutsml.examples.html" />
    <link rel="prev" title="Contributions" href="contributions.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> nutsml
          

          
          </a>

          
            
            
              <div class="version">
                1.0.38
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/introduction.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributions.html">Contributions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">nutsml package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="nutsml.examples.html">nutsml.examples package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.batcher">nutsml.batcher module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.booster">nutsml.booster module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.checkpoint">nutsml.checkpoint module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.common">nutsml.common module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.config">nutsml.config module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.datautil">nutsml.datautil module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.fileutil">nutsml.fileutil module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.imageutil">nutsml.imageutil module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.logger">nutsml.logger module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.network">nutsml.network module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.plotter">nutsml.plotter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.reader">nutsml.reader module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.stratify">nutsml.stratify module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.transformer">nutsml.transformer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.viewer">nutsml.viewer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml.writer">nutsml.writer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-nutsml">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">nutsml</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>nutsml package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/nutsml.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="nutsml-package">
<h1>nutsml package<a class="headerlink" href="#nutsml-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="nutsml.examples.html">nutsml.examples package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nutsml.examples.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="nutsml.examples.autoencoder.html">nutsml.examples.autoencoder package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.autoencoder.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.autoencoder.html#nutsml-examples-autoencoder-conv-autoencoder-module">nutsml.examples.autoencoder.conv_autoencoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.autoencoder.html#module-nutsml.examples.autoencoder.runner">nutsml.examples.autoencoder.runner module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.autoencoder.html#module-nutsml.examples.autoencoder">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="nutsml.examples.cifar.html">nutsml.examples.cifar package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.cifar.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.cifar.html#module-nutsml.examples.cifar.cnn_classify">nutsml.examples.cifar.cnn_classify module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.cifar.html#module-nutsml.examples.cifar.cnn_train">nutsml.examples.cifar.cnn_train module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.cifar.html#module-nutsml.examples.cifar.read_images">nutsml.examples.cifar.read_images module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.cifar.html#module-nutsml.examples.cifar.view_augmented_images">nutsml.examples.cifar.view_augmented_images module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.cifar.html#module-nutsml.examples.cifar.view_data">nutsml.examples.cifar.view_data module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.cifar.html#module-nutsml.examples.cifar.view_train_images">nutsml.examples.cifar.view_train_images module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.cifar.html#module-nutsml.examples.cifar.write_images">nutsml.examples.cifar.write_images module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.cifar.html#module-nutsml.examples.cifar">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="nutsml.examples.mnist.html">nutsml.examples.mnist package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.mnist.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.mnist.html#module-nutsml.examples.mnist.cnn_classify">nutsml.examples.mnist.cnn_classify module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.mnist.html#module-nutsml.examples.mnist.cnn_train">nutsml.examples.mnist.cnn_train module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.mnist.html#module-nutsml.examples.mnist.mlp_classify">nutsml.examples.mnist.mlp_classify module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.mnist.html#module-nutsml.examples.mnist.mlp_train">nutsml.examples.mnist.mlp_train module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.mnist.html#module-nutsml.examples.mnist.mlp_view_misclassified">nutsml.examples.mnist.mlp_view_misclassified module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.mnist.html#module-nutsml.examples.mnist.read_images">nutsml.examples.mnist.read_images module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.mnist.html#module-nutsml.examples.mnist.view_train_images">nutsml.examples.mnist.view_train_images module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.mnist.html#module-nutsml.examples.mnist.write_images">nutsml.examples.mnist.write_images module</a></li>
<li class="toctree-l4"><a class="reference internal" href="nutsml.examples.mnist.html#module-nutsml.examples.mnist">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="nutsml.examples.html#module-nutsml.examples">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-nutsml.batcher">
<span id="nutsml-batcher-module"></span><h2>nutsml.batcher module<a class="headerlink" href="#module-nutsml.batcher" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-batcher"></span><dl class="class">
<dt id="nutsml.batcher.BuildBatch">
<em class="property">class </em><code class="descname">BuildBatch</code><span class="sig-paren">(</span><em>batchsize</em>, <em>prefetch=1</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#BuildBatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.BuildBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.Nut</span></code></p>
<p>Build batches for GPU-based neural network training.</p>
<dl class="method">
<dt id="nutsml.batcher.BuildBatch.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>batchsize</em>, <em>prefetch=1</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#BuildBatch.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.BuildBatch.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>iterable &gt;&gt; BuildBatch(batchsize, prefetch=1, verbose=False)</p>
<p>Take samples in iterable, extract specified columns, convert
column data to numpy arrays of various types, aggregate converted
samples into a batch.</p>
<p>The following example use the verbose flag to print the shape of
the batches constructed. This is useful for development and debugging
but should be disabled (verbose=False) in production.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Collect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.1</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">class_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">images</span><span class="p">,</span> <span class="n">class_ids</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">build_batch</span> <span class="o">=</span> <span class="p">(</span><span class="n">BuildBatch</span><span class="p">(</span><span class="n">batchsize</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>               <span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="gp">... </span>               <span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>               <span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;one_hot&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batches</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">build_batch</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[[2:float32, 2x1x5x3:uint8], [2x3:uint8]]</span>
<span class="go">[[1:float32, 1x1x5x3:uint8], [1x3:uint8]]</span>
</pre></div>
</div>
<p>Sample columns can be ignored or reused. Assuming an autoencoder, one
might which to use the sample image as input and output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">build_batch</span> <span class="o">=</span> <span class="p">(</span><span class="n">BuildBatch</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>               <span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>               <span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batches</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">build_batch</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
<span class="go">[[2x1x5x3:uint8], [2x1x5x3:uint8]]</span>
<span class="go">[[1x1x5x3:uint8], [1x1x5x3:uint8]]</span>
</pre></div>
</div>
<p>A training batch is of the format [[inputs], [outputs]], e.g. in the
first case above [[number, image], [one_hot]], where each of the columns
is a Numpy array. If no output/target is provided, as in the prediction
phase, the batch format is just [inputs].</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">build_pred_batch</span> <span class="o">=</span> <span class="p">(</span><span class="n">BuildBatch</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">... </span>                    <span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="s1">&#39;uint8&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batches</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">build_pred_batch</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
<span class="go">[2x1x5x3:uint8]</span>
<span class="go">[1x1x5x3:uint8]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>batchsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of batch = number of rows in batch.</li>
<li><strong>prefetch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of batches to prefetch. This speeds up
GPU based training, since one batch is built on CPU while the
another is processed on the GPU.
Note: if verbose=True, prefetch is set to 0 to simplify debugging.</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Print batch shape when True.
(and sets prefetch=0)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.batcher.BuildBatch.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#BuildBatch.__rrshift__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.BuildBatch.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert samples in iterable into mini-batches.</p>
<p>Structure of output depends on fmt function used. If None
output is a list of np.arrays</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>iterable</strong> (<em>iterable</em>) – Iterable over samples.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Mini-batches</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list of np.array if fmt=None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.batcher.BuildBatch.by">
<code class="descname">by</code><span class="sig-paren">(</span><em>col</em>, <em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#BuildBatch.by"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.BuildBatch.by" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify and add batch columns to create batch.</p>
<p>DEPRECATED: Use input() and output() instead.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – column of the sample to extract and to create a
batch column from.</li>
<li><strong>name</strong> (<em>string</em>) – Name of the column function to apply to create
a batch column, e.g. ‘image’
See the following functions for more details:
‘image’: nutsflow.batcher.build_image_batch
‘number’: nutsflow.batcher.build_number_batch
‘vector’: nutsflow.batcher.build_vector_batch
‘tensor’: nutsflow.batcher.build_tensor_batch
‘one_hot’: nutsflow.batcher.build_one_hot_batch</li>
<li><strong>args</strong> (<em>args</em>) – Arguments for column function, e.g. dtype</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Keyword arguments for column function</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">instance of BuildBatch</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#nutsml.batcher.BuildBatch" title="nutsml.batcher.BuildBatch">BuildBatch</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.batcher.BuildBatch.input">
<code class="descname">input</code><span class="sig-paren">(</span><em>col</em>, <em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#BuildBatch.input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.BuildBatch.input" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify and add input columns for batch to create</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – column of the sample to extract and to create a
batch input column from.</li>
<li><strong>name</strong> (<em>string</em>) – Name of the column function to apply to create
a batch column, e.g. ‘image’
See the following functions for more details:
‘image’: nutsflow.batcher.build_image_batch
‘number’: nutsflow.batcher.build_number_batch
‘vector’: nutsflow.batcher.build_vector_batch
‘tensor’: nutsflow.batcher.build_tensor_batch
‘one_hot’: nutsflow.batcher.build_one_hot_batch</li>
<li><strong>args</strong> (<em>args</em>) – Arguments for column function, e.g. dtype</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Keyword arguments for column function</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">instance of BuildBatch</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#nutsml.batcher.BuildBatch" title="nutsml.batcher.BuildBatch">BuildBatch</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.batcher.BuildBatch.output">
<code class="descname">output</code><span class="sig-paren">(</span><em>col</em>, <em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#BuildBatch.output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.BuildBatch.output" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify and add output columns for batch to create</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – column of the sample to extract and to create a
batch output column from.</li>
<li><strong>name</strong> (<em>string</em>) – Name of the column function to apply to create
a batch column, e.g. ‘image’
See the following functions for more details:
‘image’: nutsflow.batcher.build_image_batch
‘number’: nutsflow.batcher.build_number_batch
‘vector’: nutsflow.batcher.build_vector_batch
‘tensor’: nutsflow.batcher.build_tensor_batch
‘one_hot’: nutsflow.batcher.build_one_hot_batch</li>
<li><strong>args</strong> (<em>args</em>) – Arguments for column function, e.g. dtype</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Keyword arguments for column function</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">instance of BuildBatch</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#nutsml.batcher.BuildBatch" title="nutsml.batcher.BuildBatch">BuildBatch</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.batcher.Mixup">
<em class="property">class </em><code class="descname">Mixup</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#Mixup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.Mixup" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Mixup produces random interpolations between data and labels.</p>
<p>Usage:
… &gt;&gt; BuildBatch() &gt;&gt; Mixup(0.1) &gt;&gt; network.train() &gt;&gt; …</p>
<p>Implementation based on the following paper:
mixup: Beyond Empirical Risk Minimization
<a class="reference external" href="https://arxiv.org/abs/1710.09412">https://arxiv.org/abs/1710.09412</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – Batch consisting of list of input data and list of
output data, where data must be numeric, e.g. images and
one-hot-encoded class labels that can be interpolated between.</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Control parameter for beta distribution the
interpolation factors are sampled from. Range: [0,…,1]
For alpha &lt;= 0 no mixup is performed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.batcher.Mixup.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>element</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.batcher.Mixup.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="nutsml.batcher.build_image_batch">
<code class="descname">build_image_batch</code><span class="sig-paren">(</span><em>images</em>, <em>dtype</em>, <em>channelfirst=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#build_image_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.build_image_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return batch of images.</p>
<p>If images have no channel a channel axis is added. For channelfirst=True
it will be added/moved to front otherwise the channel comes last.
All images in batch will have a channel axis. Batch is of shape
(n, c, h, w) or (n, h, w, c) depending on channelfirst, where n is
the number of images in the batch.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsml.datautil</span> <span class="k">import</span> <span class="n">shapestr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">build_image_batch</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="s1">&#39;uint8&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapestr</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="go">&#39;2x1x2x3&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span>
<span class="go">array([[[[0, 0, 0],</span>
<span class="go">         [0, 0, 0]]],</span>


<span class="go">       [[[1, 1, 1],</span>
<span class="go">         [1, 1, 1]]]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array images</strong> (<em>numpy</em>) – Images to batch. Must be of shape (w,h,c)
or (w,h). Gray-scale with channel is fine (w,h,1) and also
alpha channel is fine (w,h,4).</li>
<li><strong>data type dtype</strong> (<em>numpy</em>) – Data type of batch, e.g. ‘uint8’</li>
<li><strong>channelfirst</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – If True, channel is added/moved to front.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Image batch with shape (n, c, h, w) or (n, h, w, c).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.batcher.build_number_batch">
<code class="descname">build_number_batch</code><span class="sig-paren">(</span><em>numbers</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#build_number_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.build_number_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return numpy array with given dtype for given numbers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numbers</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">build_number_batch</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="go">array([1, 2, 3, 1], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>number numbers</strong> (<em>iterable</em>) – Numbers to create batch from</li>
<li><strong>data type dtype</strong> (<em>numpy</em>) – Data type of batch, e.g. ‘uint8’</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Numpy array for numbers</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.batcher.build_one_hot_batch">
<code class="descname">build_one_hot_batch</code><span class="sig-paren">(</span><em>class_ids</em>, <em>dtype</em>, <em>num_classes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#build_one_hot_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.build_one_hot_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return one hot vectors for class ids.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">class_ids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">build_one_hot_batch</span><span class="p">(</span><span class="n">class_ids</span><span class="p">,</span> <span class="s1">&#39;uint8&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">array([[1, 0, 0],</span>
<span class="go">       [0, 1, 0],</span>
<span class="go">       [0, 0, 1],</span>
<span class="go">       [0, 1, 0]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>class_ids</strong> (<em>iterable</em>) – Class indices in {0, …, num_classes-1}</li>
<li><strong>data type dtype</strong> (<em>numpy</em>) – Data type of batch, e.g. ‘uint8’</li>
<li><strong>num_classes</strong> – Number of classes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">One hot vectors for class ids.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.batcher.build_tensor_batch">
<code class="descname">build_tensor_batch</code><span class="sig-paren">(</span><em>tensors</em>, <em>dtype</em>, <em>axes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#build_tensor_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.build_tensor_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return batch of tensors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsml.datautil</span> <span class="k">import</span> <span class="n">shapestr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensors</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">build_tensor_batch</span><span class="p">(</span><span class="n">tensors</span><span class="p">,</span> <span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapestr</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="go">&#39;2x2x3&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="go">[[[0 0 0]</span>
<span class="go">  [0 0 0]]</span>

<span class="go"> [[1 1 1]</span>
<span class="go">  [1 1 1]]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">build_tensor_batch</span><span class="p">(</span><span class="n">tensors</span><span class="p">,</span> <span class="s1">&#39;uint8&#39;</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapestr</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="go">&#39;2x3x2&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="go">[[[0 0]</span>
<span class="go">  [0 0]</span>
<span class="go">  [0 0]]</span>

<span class="go"> [[1 1]</span>
<span class="go">  [1 1]</span>
<span class="go">  [1 1]]]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tensors</strong> (<em>iterable</em>) – Numpy tensors</li>
<li><strong>data type dtype</strong> (<em>numpy</em>) – Data type of batch, e.g. ‘uint8’</li>
<li><strong>axes</strong> (<em>tuple|None</em>) – axes order, e.g. to move a channel axis to the
last position. (see numpy transpose for details)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">stack of tensors, with batch axis first.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.batcher.build_vector_batch">
<code class="descname">build_vector_batch</code><span class="sig-paren">(</span><em>vectors</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/batcher.html#build_vector_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.batcher.build_vector_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Return batch of vectors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsml.datautil</span> <span class="k">import</span> <span class="n">shapestr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vectors</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span> <span class="o">=</span> <span class="n">build_vector_batch</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapestr</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
<span class="go">&#39;2x3&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">batch</span>
<span class="go">array([[1, 2, 3],</span>
<span class="go">       [2, 3, 4]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vectors</strong> (<em>iterable</em>) – Numpy row vectors</li>
<li><strong>data type dtype</strong> (<em>numpy</em>) – Data type of batch, e.g. ‘uint8’</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">vstack of vectors</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-nutsml.booster">
<span id="nutsml-booster-module"></span><h2>nutsml.booster module<a class="headerlink" href="#module-nutsml.booster" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-booster"></span><dl class="class">
<dt id="nutsml.booster.Boost">
<em class="property">class </em><code class="descname">Boost</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/booster.html#Boost"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.booster.Boost" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.Nut</span></code></p>
<p>iterable &gt;&gt; Boost(batcher, network, targetcol=-1)</p>
<p>Boost samples with high softmax probability for incorrect class.
Expects one-hot encoded targets and softmax predictions for output.</p>
<div class="line-block">
<div class="line">network = Network()</div>
<div class="line">build_batch = BuildBatch(BATCHSIZE)</div>
<div class="line">boost = Boost(build_batch, network)</div>
<div class="line">samples &gt;&gt; boost &gt;&gt; build_batch &gt;&gt; network.train() &gt;&gt; Consume()</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> (<em>iterable</em>) – Iterable with samples.</li>
<li><strong>batcher</strong> (<em>nutsml.BuildBatch</em>) – Batcher used for network training.</li>
<li><strong>network</strong> (<em>nutsml.Network</em>) – Network used for prediction</li>
<li><strong>targetcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Column in sample that contains target values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Generator over samples to boost</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">generator</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.booster.Boost.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.booster.Boost.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="nutsml.booster.random">
<code class="descname">random</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; x in the interval [0, 1).<a class="headerlink" href="#nutsml.booster.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-nutsml.checkpoint">
<span id="nutsml-checkpoint-module"></span><h2>nutsml.checkpoint module<a class="headerlink" href="#module-nutsml.checkpoint" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-checkpoint"></span><dl class="class">
<dt id="nutsml.checkpoint.Checkpoint">
<em class="property">class </em><code class="descname">Checkpoint</code><span class="sig-paren">(</span><em>create_net</em>, <em>parameters</em>, <em>checkpointspath='checkpoints'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/checkpoint.html#Checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.checkpoint.Checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A factory for checkpoints to periodically save network weights and other
hyper/configuration parameters.</p>
<div class="line-block">
<div class="line">Example usage:</div>
<div class="line"><br /></div>
<div class="line">def create_network(lr=0.01, momentum=0.9):</div>
<div class="line-block">
<div class="line">model = Sequential()</div>
<div class="line">…</div>
<div class="line">optimizer = opt.SGD(lr=lr, momentum=momentum)</div>
<div class="line">model.compile(optimizer=optimizer, metrics=[‘accuracy’])</div>
<div class="line">return KerasNetwork(model), optimizer</div>
<div class="line"><br /></div>
</div>
<div class="line">def parameters(network, optimizer):</div>
<div class="line-block">
<div class="line">return dict(lr = optimizer.lr, momentum = optimizer.momentum)</div>
<div class="line"><br /></div>
</div>
<div class="line">def train_network():</div>
<div class="line-block">
<div class="line">checkpoint = Checkpoint(create_network, parameters)</div>
<div class="line">network, optimizer = checkpoint.load()</div>
<div class="line"><br /></div>
<div class="line">for epoch in xrange(EPOCHS):</div>
<div class="line-block">
<div class="line">train_err = train_network()</div>
<div class="line">val_err = validate_network()</div>
<div class="line"><br /></div>
<div class="line">if epoch % 10 == 0:  # Reduce learning rate every 10 epochs</div>
<div class="line-block">
<div class="line">optimizer.lr /= 2</div>
<div class="line"><br /></div>
</div>
<div class="line">checkpoint.save_best(val_err)</div>
<div class="line"><br /></div>
</div>
</div>
</div>
<p>Checkpoints can also be saved under different names, e.g.</p>
<div class="line-block">
<div class="line">checkpoint.save_best(val_err, ‘checkpoint’+str(epoch))</div>
</div>
<p>And specific checkpoints can be loaded:</p>
<div class="line-block">
<div class="line">network, config = checkpoint.load(‘checkpoint103’)</div>
</div>
<p>If no checkpoint is specified the most recent one is loaded.</p>
<dl class="method">
<dt id="nutsml.checkpoint.Checkpoint.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>create_net</em>, <em>parameters</em>, <em>checkpointspath='checkpoints'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/checkpoint.html#Checkpoint.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.checkpoint.Checkpoint.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create checkpoint factory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">create_network</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="s1">&#39;MyNetwork&#39;</span><span class="p">,</span> <span class="n">lr</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">lr</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lr</span> <span class="o">=</span> <span class="n">lr</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">checkpoint</span> <span class="o">=</span> <span class="n">Checkpoint</span><span class="p">(</span><span class="n">create_network</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network</span><span class="p">,</span> <span class="n">lr</span> <span class="o">=</span> <span class="n">checkpoint</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network</span><span class="p">,</span> <span class="n">lr</span>
<span class="go">(&#39;MyNetwork&#39;, 0.1)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>create_net</strong> (<em>function</em>) – Function that takes keyword parameters
and returns a nuts-ml Network and and any other values or objects
needed to describe the state to be checkpointed.
Note: parameters(<a href="#id1"><span class="problematic" id="id2">*</span></a>create_net()) must work!</li>
<li><strong>parameters</strong> (<em>function</em>) – Function that takes output of create_net()
and returns dictionary with parameters (same as the one that are
used in create_net(…))</li>
<li><strong>checkpointspath</strong> (<em>string</em>) – Path to folder that will contain
checkpoint folders.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.checkpoint.Checkpoint.datapaths">
<code class="descname">datapaths</code><span class="sig-paren">(</span><em>checkpointname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/checkpoint.html#Checkpoint.datapaths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.checkpoint.Checkpoint.datapaths" title="Permalink to this definition">¶</a></dt>
<dd><p>Return paths to network weights, parameters and config files.</p>
<p>If no checkpoints exist under basedir (None, None, None) is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>checkpointname</strong> (<em>str|None</em>) – Name of checkpoint. If name is None
the most recent checkpoint is used.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(weightspath, paramspath, configpath) or (None, None, None)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.checkpoint.Checkpoint.dirs">
<code class="descname">dirs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/checkpoint.html#Checkpoint.dirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.checkpoint.Checkpoint.dirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return full paths to all checkpoint folders.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Paths to all folders under the basedir.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)">list</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.checkpoint.Checkpoint.latest">
<code class="descname">latest</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/checkpoint.html#Checkpoint.latest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.checkpoint.Checkpoint.latest" title="Permalink to this definition">¶</a></dt>
<dd><p>Find most recently modified/created checkpoint folder.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Full path to checkpoint folder if it exists otherwise None.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">str | None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.checkpoint.Checkpoint.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>checkpointname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/checkpoint.html#Checkpoint.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.checkpoint.Checkpoint.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Create network, load weights and parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>checkpointname</strong> (<em>str|none</em>) – Name of checkpoint to load. If None
the most recent checkpoint is used. If no checkpoint exists yet
the network will be created but no weights loaded and the
default configuration will be returned.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">whatever self.create_net returns</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)">object</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.checkpoint.Checkpoint.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>checkpointname='checkpoint'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/checkpoint.html#Checkpoint.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.checkpoint.Checkpoint.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save network weights and parameters under the given name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>checkpointname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Name of checkpoint folder. Path will be
self.basepath/checkpointname</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">path to checkpoint folder</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.checkpoint.Checkpoint.save_best">
<code class="descname">save_best</code><span class="sig-paren">(</span><em>score</em>, <em>checkpointname='checkpoint'</em>, <em>isloss=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/checkpoint.html#Checkpoint.save_best"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.checkpoint.Checkpoint.save_best" title="Permalink to this definition">¶</a></dt>
<dd><p>Save best network weights and parameters under the given name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>score</strong> (<em>float|int</em>) – Some score indicating quality of network.</li>
<li><strong>checkpointname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Name of checkpoint folder.</li>
<li><strong>isloss</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True, score is a loss and lower is better otherwise
higher is better.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">path to checkpoint folder</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)">str</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nutsml.common">
<span id="nutsml-common-module"></span><h2>nutsml.common module<a class="headerlink" href="#module-nutsml.common" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-common"></span><dl class="class">
<dt id="nutsml.common.CheckNaN">
<em class="property">class </em><code class="descname">CheckNaN</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/common.html#CheckNaN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.common.CheckNaN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Raise exception if data contains NaN.</p>
<p>Useful to stop training if network doesn’t converge and loss gets NaN,
e.g. samples &gt;&gt; network.train() &gt;&gt; CheckNan() &gt;&gt; log &gt;&gt; Consume()</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Collect</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">CheckNaN</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">CheckNaN</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">NaN encountered: nan</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> – Items or iterables.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Return input data if they don’t contain NaNs</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">any</td>
</tr>
<tr class="field-even field"><th class="field-name">Raise:</th><td class="field-body">RuntimeError if data contains NaN.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.common.CheckNaN.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>element</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.common.CheckNaN.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.common.ConvertLabel">
<em class="property">class </em><code class="descname">ConvertLabel</code><span class="sig-paren">(</span><em>column</em>, <em>labels</em>, <em>onehot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/common.html#ConvertLabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.common.ConvertLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Convert string labels to integer class ids (or one-hot) and vice versa.</p>
<dl class="method">
<dt id="nutsml.common.ConvertLabel.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/common.html#ConvertLabel.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.common.ConvertLabel.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return sample and replace label within sample if it is a sample</p>
</dd></dl>

<dl class="method">
<dt id="nutsml.common.ConvertLabel.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>column</em>, <em>labels</em>, <em>onehot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/common.html#ConvertLabel.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.common.ConvertLabel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert string labels to integer class ids (or one-hot) and vice versa.</p>
<p>Also converts confidence vectors, e.g. softmax output or float values
to class labels.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Collect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;class0&#39;</span><span class="p">,</span> <span class="s1">&#39;class1&#39;</span><span class="p">,</span> <span class="s1">&#39;class2&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convert</span> <span class="o">=</span> <span class="n">ConvertLabel</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">convert</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[&#39;class1&#39;, &#39;class0&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="s1">&#39;class1&#39;</span><span class="p">,</span> <span class="s1">&#39;class0&#39;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">convert</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[1, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">convert</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[&#39;class1&#39;, &#39;class0&#39;, &#39;class2&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]]</span> <span class="o">&gt;&gt;</span> <span class="n">convert</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[&#39;class1&#39;, &#39;class0&#39;]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convert</span> <span class="o">=</span> <span class="n">ConvertLabel</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">onehot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="s1">&#39;class1&#39;</span><span class="p">,</span> <span class="s1">&#39;class0&#39;</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="n">convert</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[[0, 1, 0], [1, 0, 0]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">convert</span> <span class="o">=</span> <span class="n">ConvertLabel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;class1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="s1">&#39;class0&#39;</span><span class="p">)]</span> <span class="o">&gt;&gt;</span> <span class="n">convert</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[(&#39;data&#39;, 1), (&#39;data&#39;, 0)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span> <span class="o">&gt;&gt;</span> <span class="n">convert</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[(&#39;data&#39;, &#39;class1&#39;), (&#39;data&#39;, &#39;class2&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)]</span> <span class="o">&gt;&gt;</span> <span class="n">convert</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[(&#39;data&#39;, &#39;class1&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])]</span> <span class="o">&gt;&gt;</span> <span class="n">convert</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[(&#39;data&#39;, &#39;class1&#39;)]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>column</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of column in sample that contains label.
If None process labels directly.</li>
<li><strong>labels</strong> (<em>list|tuple</em>) – List of class labels (strings).</li>
<li><strong>onehot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True: convert class labels to one-hot encoded
vectors. False, convert to class index.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.common.PartitionByCol">
<em class="property">class </em><code class="descname">PartitionByCol</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/common.html#PartitionByCol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.common.PartitionByCol" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutSink</span></code></p>
<p>Partition samples in iterables depending on column value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ones</span><span class="p">,</span> <span class="n">twos</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">PartitionByCol</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ones</span>
<span class="go">[(1, 1), (1, 3)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">twos</span>
<span class="go">[(2, 0), (2, 4)]</span>
</pre></div>
</div>
<p>Note that values does not need to contain all possible values. It is
sufficient to provide the values for the partitions wanted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> (<em>iterable</em>) – Iterable over samples</li>
<li><strong>column</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of column to extract</li>
<li><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of column values to create partitions for.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">tuple of partitions</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.common.PartitionByCol.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.common.PartitionByCol.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.common.SplitRandom">
<em class="property">class </em><code class="descname">SplitRandom</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/common.html#SplitRandom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.common.SplitRandom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutSink</span></code></p>
<p>Randomly split iterable into partitions.</p>
<p>For the same input data the same split is created every time and is stable
across different Python version 2.x or 3.x. A random number generator
can be provided to create varying splits.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">train</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SplitRandom</span><span class="p">(</span><span class="n">ratio</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train</span><span class="p">,</span> <span class="n">val</span>
<span class="go">([6, 3, 1, 7, 0, 2, 4], [5, 9, 8])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SplitRandom</span><span class="p">(</span><span class="n">ratio</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>  <span class="c1"># Same split again</span>
<span class="go">[[6, 3, 1, 7, 0, 2, 4], [5, 9, 8]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">SplitRandom</span><span class="p">(</span><span class="n">ratio</span><span class="o">=</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">test</span>
<span class="go">([6, 1, 4, 0, 3, 2], [8, 7, 9], [5])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="s1">&#39;aabbccddee&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">same_letter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&gt;&gt;</span> <span class="n">SplitRandom</span><span class="p">(</span><span class="n">ratio</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">same_letter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train</span>
<span class="go">[(&#39;a&#39;, 1), (&#39;a&#39;, 0), (&#39;d&#39;, 7), (&#39;b&#39;, 2), (&#39;d&#39;, 6), (&#39;b&#39;, 3)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span>
<span class="go">[(&#39;c&#39;, 5), (&#39;e&#39;, 8), (&#39;e&#39;, 9), (&#39;c&#39;, 4)]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> (<em>iterable</em>) – Iterable over anything. Will be consumed!</li>
<li><strong>ratio</strong> (<em>float|tuple</em>) – Ratio of two partition e.g. a ratio of 0.7
means 70%, 30% split.
Alternatively a list or ratios can be provided, e.g.
ratio=(0.6, 0.3, 0.1). Note that ratios must sum up to one.</li>
<li><strong>constraint</strong> (<em>function|None</em>) – Function that returns key the elements of
the iterable are grouped by before partitioning. Useful to ensure
that a partition contains related elements, e.g. left and right eye
images are not scattered across partitions.
Note that constrains have precedence over ratios.</li>
<li><strong>rand</strong> (<em>Random|None</em>) – Random number generator. The default None
ensures that the same split is created every time SplitRandom
is called. This is important when continuing an interrupted
training session or running the same training on machines with
different Python versions. Note that Python’s random.Random(0)
generates different number for Python 2.x and 3.x!</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">partitions of iterable with sizes according to provided ratios.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)">list</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)">list</a>, ..)</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.common.SplitRandom.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.common.SplitRandom.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nutsml.config">
<span id="nutsml-config-module"></span><h2>nutsml.config module<a class="headerlink" href="#module-nutsml.config" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-config"></span><dl class="class">
<dt id="nutsml.config.Config">
<em class="property">class </em><code class="descname">Config</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/config.html#Config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.config.Config" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
<p>Dictionary that allows access via keys or attributes.</p>
<p>Used to store and access configuration data.</p>
<dl class="method">
<dt id="nutsml.config.Config.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/config.html#Config.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.config.Config.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create dictionary.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contact</span> <span class="o">=</span> <span class="n">Config</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;stefan&#39;</span><span class="p">,</span> <span class="s1">&#39;address&#39;</span><span class="p">:{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span><span class="mi">12</span><span class="p">}})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contact</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
<span class="go">&#39;stefan&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contact</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;stefan&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contact</span><span class="o">.</span><span class="n">address</span><span class="o">.</span><span class="n">number</span>
<span class="go">12</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">contact</span><span class="o">.</span><span class="n">surname</span> <span class="o">=</span> <span class="s1">&#39;maetschke&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">contact</span><span class="o">.</span><span class="n">surname</span>
<span class="go">&#39;maetschke&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>args</strong> (<em>args</em>) – See dict</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – See dict</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="nutsml.config.Config.isjson">
<em class="property">static </em><code class="descname">isjson</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/config.html#Config.isjson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.config.Config.isjson" title="Permalink to this definition">¶</a></dt>
<dd><p>Return true if filepath ends with ‘.json’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Filepaht</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if filepath points ot JSON file.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)">bool</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.config.Config.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/config.html#Config.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.config.Config.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load configuration from file in JSON or YAML format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;tests/data/configuration.json&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span><span class="o">.</span><span class="n">number</span>
<span class="go">13</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Path to JSON or YAML file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">returns loaded configuration.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#nutsml.config.Config" title="nutsml.config.Config">Config</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.config.Config.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/config.html#Config.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.config.Config.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save configuration to file in JSON or YAML format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">Config</span><span class="p">({</span><span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Stefan&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;tests/data/configuration.yaml&#39;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Filepath. Should end with ‘.json’ or ‘.yaml’</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="nutsml.config.load_config">
<code class="descname">load_config</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/config.html#load_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.config.load_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Load configuration file in YAML format from locations in defined order.</p>
<p>The search order for the config file is:
1) user home dir
2) current dir
3) full path</p>
<div class="line-block">
<div class="line">Example file: ‘tests/data/config.yaml’</div>
<div class="line">filepath : c:/Maet</div>
<div class="line">imagesize : [100, 200]</div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span> <span class="o">=</span> <span class="n">load_config</span><span class="p">(</span><span class="s1">&#39;tests/data/config.yaml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span><span class="o">.</span><span class="n">filepath</span>
<span class="go">&#39;c:/Maet&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;imagesize&#39;</span><span class="p">]</span>
<span class="go">[100, 200]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> – Name or full path of configuration file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dictionary with config data. Note that config data can be
accessed by key or attribute, e.g. cfg.filepath or cfg.[‘filepath’]</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ConfigDict</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-nutsml.datautil">
<span id="nutsml-datautil-module"></span><h2>nutsml.datautil module<a class="headerlink" href="#module-nutsml.datautil" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-datautil"></span><dl class="function">
<dt id="nutsml.datautil.col_map">
<code class="descname">col_map</code><span class="sig-paren">(</span><em>sample</em>, <em>columns</em>, <em>func</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/datautil.html#col_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.datautil.col_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Map function to given columns of sample and keep other columns</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sample</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_n</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">n</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col_map</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">add_n</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">(1, 12, 3)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">col_map</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">add_n</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">(11, 2, 13)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sample</strong> (<em>tuple|list</em>) – Sample</li>
<li><strong>columns</strong> (<em>int|tuple</em>) – Single or multiple column indices.</li>
<li><strong>func</strong> (<em>function</em>) – Function to map</li>
<li><strong>args</strong> (<em>args</em>) – Arguments passed on to function</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Keyword arguments passed on to function</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Sample where function has been applied to elements in the given
columns.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.datautil.group_by">
<code class="descname">group_by</code><span class="sig-paren">(</span><em>elements</em>, <em>keyfunc</em>, <em>ordered=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/datautil.html#group_by"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.datautil.group_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Group elements using the given key function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">is_odd</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">x</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">group_by</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">is_odd</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">OrderedDict([(False, [0, 2, 4]), (True, [1, 3])])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>elements</strong> (<em>iterable</em>) – Any iterable</li>
<li><strong>keyfunc</strong> (<em>function</em>) – Function that returns key to group by</li>
<li><strong>ordered</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True: return OrderedDict else return dict</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dictionary with results of keyfunc as keys and the elements
for that key as value</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict|OrderedDict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.datautil.group_samples">
<code class="descname">group_samples</code><span class="sig-paren">(</span><em>samples</em>, <em>labelcol</em>, <em>ordered=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/datautil.html#group_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.datautil.group_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Return samples grouped by label and label counts.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span><span class="p">,</span> <span class="n">labelcnts</span> <span class="o">=</span> <span class="n">group_samples</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span>
<span class="go">OrderedDict([(1, [(&#39;pos&#39;, 1), (&#39;pos&#39;, 1)]), (0, [(&#39;neg&#39;, 0)])])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labelcnts</span>
<span class="go">Counter({1: 2, 0: 1})</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples</strong> (<em>iterable</em>) – Iterable of samples where each sample has a
label at a fixed position (labelcol)</li>
<li><strong>labelcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of label in sample</li>
<li><strong>ordered</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True: samples are kept in order when grouping.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(groups, labelcnts) where groups is a dict containing
samples grouped by label, and labelcnts is a Counter dict
containing label frequencies.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)">dict</a>, Counter)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.datautil.isnan">
<code class="descname">isnan</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/datautil.html#isnan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.datautil.isnan" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if something is NaN.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">isnan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">isnan</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><em>object</em></a>) – Any object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if x is NaN</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)">bool</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.datautil.random_downsample">
<code class="descname">random_downsample</code><span class="sig-paren">(</span><em>samples</em>, <em>labelcol</em>, <em>rand=None</em>, <em>ordered=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/datautil.html#random_downsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.datautil.random_downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly down-sample samples.</p>
<p>Creates stratified samples by down-sampling larger classes to the size of
the smallest class.</p>
<p>Note: The example shown below uses StableRandom(i) to create a deterministic
sequence of randomly stratified samples. Usually it is sufficient to use
the default (rand=None). Do NOT use rnd.Random(0) since this
will generate the same subsample every time.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>  
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow.common</span> <span class="k">import</span> <span class="n">StableRandom</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;pos1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;pos2&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;pos3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">... </span>           <span class="p">(</span><span class="s1">&#39;neg1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;neg2&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">random_downsample</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">StableRandom</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="kc">True</span><span class="p">))</span>
<span class="go">[(&#39;pos2&#39;, 1), (&#39;pos3&#39;, 1), (&#39;neg2&#39;, 0), (&#39;neg1&#39;, 0)]</span>
<span class="go">[(&#39;pos2&#39;, 1), (&#39;pos3&#39;, 1), (&#39;neg2&#39;, 0), (&#39;neg1&#39;, 0)]</span>
<span class="go">[(&#39;pos2&#39;, 1), (&#39;pos1&#39;, 1), (&#39;neg1&#39;, 0), (&#39;neg2&#39;, 0)]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples</strong> (<em>iterable</em>) – Iterable of samples where each sample has a
label at a fixed position (labelcol). Labels can be any hashable type,
e.g. int, str, bool</li>
<li><strong>labelcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of label in sample</li>
<li><strong>rand</strong> (<em>Random|None</em>) – Random number generator. If None,
random.Random(None) is used.</li>
<li><strong>ordered</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True: samples are kept in order when downsampling.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Stratified sample set.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of samples</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.datautil.shapestr">
<code class="descname">shapestr</code><span class="sig-paren">(</span><em>array</em>, <em>with_dtype=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/datautil.html#shapestr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.datautil.shapestr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string representation of array shape.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapestr</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&#39;3x4&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapestr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;3x4:uint8&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>ndarray</em>) – Numpy array</li>
<li><strong>with_dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Append dtype of array to shape string</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Shape as string, e.g shape (3,4) becomes 3x4</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)">str</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.datautil.shuffle_sublists">
<code class="descname">shuffle_sublists</code><span class="sig-paren">(</span><em>sublists</em>, <em>rand</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/datautil.html#shuffle_sublists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.datautil.shuffle_sublists" title="Permalink to this definition">¶</a></dt>
<dd><p>Shuffles the lists within a list but not the list itself.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow.common</span> <span class="k">import</span> <span class="n">StableRandom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rand</span> <span class="o">=</span> <span class="n">StableRandom</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sublists</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shuffle_sublists</span><span class="p">(</span><span class="n">sublists</span><span class="p">,</span> <span class="n">rand</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sublists</span>
<span class="go">[[1, 3, 2], [4, 5, 7, 6]]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sublists</strong> – A list containing lists</li>
<li><strong>rand</strong> (<em>Random</em>) – A random number generator.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.datautil.upsample">
<code class="descname">upsample</code><span class="sig-paren">(</span><em>samples</em>, <em>labelcol</em>, <em>rand=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/datautil.html#upsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.datautil.upsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Up-sample sample set.</p>
<p>Creates stratified samples by up-sampling smaller classes to the size of
the largest class.</p>
<p>Note: The example shown below uses rnd.Random(i) to create a deterministic
sequence of randomly stratified samples. Usually it is sufficient to use
the default (rand=None).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span> <span class="k">as</span> <span class="nn">rnd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;pos1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;pos2&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;neg1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>  
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">upsample</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">rand</span><span class="o">=</span><span class="n">rnd</span><span class="o">.</span><span class="n">Random</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
<span class="go">[(&#39;neg1&#39;, 0), (&#39;neg1&#39;, 0), (&#39;pos1&#39;, 1), (&#39;pos2&#39;, 1)]</span>
<span class="go">[(&#39;pos2&#39;, 1), (&#39;neg1&#39;, 0), (&#39;pos1&#39;, 1), (&#39;neg1&#39;, 0)]</span>
<span class="go">[(&#39;neg1&#39;, 0), (&#39;neg1&#39;, 0), (&#39;pos1&#39;, 1), (&#39;pos2&#39;, 1)]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples</strong> (<em>iterable</em>) – Iterable of samples where each sample has a
label at a fixed position (labelcol). Labels can by any hashable type,
e.g. int, str, bool</li>
<li><strong>labelcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of label in sample</li>
<li><strong>rand</strong> (<em>Random|None</em>) – Random number generator. If None,
random.Random(None) is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Stratified sample set.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of samples</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-nutsml.fileutil">
<span id="nutsml-fileutil-module"></span><h2>nutsml.fileutil module<a class="headerlink" href="#module-nutsml.fileutil" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-fileutil"></span><dl class="function">
<dt id="nutsml.fileutil.clear_folder">
<code class="descname">clear_folder</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/fileutil.html#clear_folder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.fileutil.clear_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all content (files and folders) within the specified folder.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Path of folder to clear.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.fileutil.create_filename">
<code class="descname">create_filename</code><span class="sig-paren">(</span><em>prefix=''</em>, <em>ext=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/fileutil.html#create_filename"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.fileutil.create_filename" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a unique filename.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Prefix to add to filename.</li>
<li><strong>ext</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Extension to append to filename, e.g. ‘jpg’</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Unique filename.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)">str</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.fileutil.create_folders">
<code class="descname">create_folders</code><span class="sig-paren">(</span><em>path</em>, <em>mode=511</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/fileutil.html#create_folders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.fileutil.create_folders" title="Permalink to this definition">¶</a></dt>
<dd><p>Create folder(s). Don’t fail if already existing.</p>
<p>See related functions <a class="reference internal" href="#nutsml.fileutil.delete_folders" title="nutsml.fileutil.delete_folders"><code class="xref py py-func docutils literal notranslate"><span class="pre">delete_folders()</span></code></a> and <a class="reference internal" href="#nutsml.fileutil.clear_folder" title="nutsml.fileutil.clear_folder"><code class="xref py py-func docutils literal notranslate"><span class="pre">clear_folder()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Path of folders to create, e.g. ‘foo/bar’</li>
<li><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – File creation mode, e.g. 0777</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.fileutil.create_temp_filepath">
<code class="descname">create_temp_filepath</code><span class="sig-paren">(</span><em>prefix=''</em>, <em>ext=''</em>, <em>relative=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/fileutil.html#create_temp_filepath"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.fileutil.create_temp_filepath" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a temporary folder under <code class="xref py py-data docutils literal notranslate"><span class="pre">TEMP_FOLDER</span></code>.</p>
<p>If the folder already exists do nothing. Return relative (default) or
absolute path to a temp file with a unique name.</p>
<p>See related function <a class="reference internal" href="#nutsml.fileutil.create_filename" title="nutsml.fileutil.create_filename"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_filename()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Prefix to add to filename.</li>
<li><strong>ext</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Extension to append to filename, e.g. ‘jpg’</li>
<li><strong>relative</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True: return relative path, otherwise absolute path.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Path to file with unique name in temp folder.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)">str</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.fileutil.delete_file">
<code class="descname">delete_file</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/fileutil.html#delete_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.fileutil.delete_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove file at given path. Don’t fail if non-existing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Path to file to delete, e.g. ‘foo/bar/file.txt’</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.fileutil.delete_folders">
<code class="descname">delete_folders</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/fileutil.html#delete_folders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.fileutil.delete_folders" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove folder and sub-folders. Don’t fail if non-existing or not empty.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Path of folders to delete, e.g. ‘foo/bar’</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.fileutil.delete_temp_data">
<code class="descname">delete_temp_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/fileutil.html#delete_temp_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.fileutil.delete_temp_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove <code class="xref py py-data docutils literal notranslate"><span class="pre">TEMP_FOLDER</span></code> and all its contents.</p>
</dd></dl>

</div>
<div class="section" id="module-nutsml.imageutil">
<span id="nutsml-imageutil-module"></span><h2>nutsml.imageutil module<a class="headerlink" href="#module-nutsml.imageutil" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-imageutil"></span><dl class="function">
<dt id="nutsml.imageutil.add_channel">
<code class="descname">add_channel</code><span class="sig-paren">(</span><em>image</em>, <em>channelfirst</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#add_channel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.add_channel" title="Permalink to this definition">¶</a></dt>
<dd><p>Add channel if missing and make first axis if requested.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">add_channel</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapestr</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="go">&#39;1x10x20&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>ndarray</em>) – RBG (h,w,3) or gray-scale image (h,w).</li>
<li><strong>channelfirst</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – If True, make channel first axis</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Numpy array with channel (as first axis if makefirst=True)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.annotation2coords">
<code class="descname">annotation2coords</code><span class="sig-paren">(</span><em>image</em>, <em>annotation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#annotation2coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.annotation2coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert geometric annotation in image to pixel coordinates.</p>
<p>For example, given a rectangular region annotated in an image as
(‘rect’, ((x, y, w, h))) the function returns the coordinates of all pixels
within this region as (row, col) position tuples.</p>
<p>The following annotation formats are supported:
(‘point’, ((x, y), … ))
(‘circle’, ((x, y, r), …))
(‘ellipse’, ((x, y, rx, ry, rot), …))
(‘rect’, ((x, y, w, h), …))
(‘polyline’, (((x, y), (x, y), …), …))</p>
<p>Annotation regions can exceed the image dimensions and will be clipped.
Note that annotation is in x,y order while output is r,c (row, col).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">anno</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;point&#39;</span><span class="p">,</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="ow">in</span> <span class="n">annotation2coords</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">anno</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rr</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">cc</span><span class="p">))</span>
<span class="go">[1] [1]</span>
<span class="go">[2] [1]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>ndarray</em>) – Image</li>
<li><strong>annotation</strong> (<em>annotation</em>) – Annotation of an image region such as
point, circle, rect or polyline</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Coordinates of pixels within the (clipped) region.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">generator over tuples (row, col)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.annotation2mask">
<code class="descname">annotation2mask</code><span class="sig-paren">(</span><em>image</em>, <em>annotations</em>, <em>pos=255</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#annotation2mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.annotation2mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert geometric annotation to mask.</p>
<p>For annotation formats see:
imageutil.annotation2coords</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">anno</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;point&#39;</span><span class="p">,</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">annotation2mask</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">anno</span><span class="p">)</span>
<span class="go">array([[  0,   0, 255],</span>
<span class="go">       [255,   0,   0],</span>
<span class="go">       [  0,   0,   0]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>annotation</strong> (<em>annotation</em>) – Annotation of an image region such as
point, circle, rect or polyline</li>
<li><strong>pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Value to write in mask for regions defined by annotation</li>
<li><strong>array image</strong> (<em>numpy</em>) – Image annotation refers to.
Returned mask will be of same size.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Mask with annotation</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.annotation2pltpatch">
<code class="descname">annotation2pltpatch</code><span class="sig-paren">(</span><em>annotation</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#annotation2pltpatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.annotation2pltpatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert geometric annotation to matplotlib geometric objects (=patches)</p>
<p>For details regarding matplotlib patches see:
<a class="reference external" href="http://matplotlib.org/api/patches_api.html">http://matplotlib.org/api/patches_api.html</a>
For annotation formats see:
imageutil.annotation2coords</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>annotation</strong> (<em>annotation</em>) – Annotation of an image region such as
point, circle, rect or polyline</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">matplotlib.patches</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">generator over matplotlib patches</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.arr_to_pil">
<code class="descname">arr_to_pil</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#arr_to_pil"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.arr_to_pil" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert numpy array to PIL image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">arr_to_pil</span><span class="p">(</span><span class="n">rgb_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span><span class="o">.</span><span class="n">size</span>
<span class="go">(4, 5)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<em>ndarray</em>) – Numpy array with dtype ‘uint8’ and dimensions
(h,w,c) for RGB or (h,w) for gray-scale images.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">PIL image</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">PIL.Image</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.centers_inside">
<code class="descname">centers_inside</code><span class="sig-paren">(</span><em>centers</em>, <em>image</em>, <em>pshape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#centers_inside"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.centers_inside" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter center points of patches ensuring that patch is inside of image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">centers_inside</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="go">array([[1, 2]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>centers</strong> (<em>ndarray</em><em>(</em><em>n</em><em>,</em><em>2</em><em>)</em>) – Center points of patches.</li>
<li><strong>image</strong> (<em>ndarray</em><em>(</em><em>h</em><em>,</em><em>w</em><em>)</em>) – Image the patches should be inside.</li>
<li><strong>pshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Patch shape of form (h,w)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Patch centers where the patch is completely inside the image.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray of shape (n, 2)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.change_brightness">
<code class="descname">change_brightness</code><span class="sig-paren">(</span><em>image</em>, <em>brightness=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#change_brightness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.change_brightness" title="Permalink to this definition">¶</a></dt>
<dd><p>Change brightness of image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">change_brightness</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="go">array([[127,   0,   0],</span>
<span class="go">       [  0, 127,   0],</span>
<span class="go">       [  0,   0, 127]], dtype=uint8)</span>
</pre></div>
</div>
<p>See
<a class="reference external" href="http://pillow.readthedocs.io/en/3.1.x/reference/ImageEnhance.html#PIL.ImageEnhance.Brightness">http://pillow.readthedocs.io/en/3.1.x/reference/ImageEnhance.html#PIL.ImageEnhance.Brightness</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</li>
<li><strong>brightness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Brightness [0, 1]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Image with changed brightness</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with range [0,255] and dtype ‘uint8’</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.change_color">
<code class="descname">change_color</code><span class="sig-paren">(</span><em>image</em>, <em>color=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#change_color"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.change_color" title="Permalink to this definition">¶</a></dt>
<dd><p>Change color of image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">change_color</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="go">array([[255,   0,   0],</span>
<span class="go">       [  0, 255,   0],</span>
<span class="go">       [  0,   0, 255]], dtype=uint8)</span>
</pre></div>
</div>
<p>See
<a class="reference external" href="http://pillow.readthedocs.io/en/3.1.x/reference/ImageEnhance.html#PIL.ImageEnhance.Color">http://pillow.readthedocs.io/en/3.1.x/reference/ImageEnhance.html#PIL.ImageEnhance.Color</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</li>
<li><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Color [0, 1]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Image with changed color</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with range [0,255] and dtype ‘uint8’</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.change_contrast">
<code class="descname">change_contrast</code><span class="sig-paren">(</span><em>image</em>, <em>contrast=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#change_contrast"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.change_contrast" title="Permalink to this definition">¶</a></dt>
<dd><p>Change contrast of image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">change_contrast</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="go">array([[170,  42,  42],</span>
<span class="go">       [ 42, 170,  42],</span>
<span class="go">       [ 42,  42, 170]], dtype=uint8)</span>
</pre></div>
</div>
<p>See
<a class="reference external" href="http://pillow.readthedocs.io/en/3.1.x/reference/ImageEnhance.html#PIL.ImageEnhance.Contrast">http://pillow.readthedocs.io/en/3.1.x/reference/ImageEnhance.html#PIL.ImageEnhance.Contrast</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</li>
<li><strong>contrast</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Contrast [0, 1]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Image with changed contrast</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with range [0,255] and dtype ‘uint8’</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.change_sharpness">
<code class="descname">change_sharpness</code><span class="sig-paren">(</span><em>image</em>, <em>sharpness=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#change_sharpness"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.change_sharpness" title="Permalink to this definition">¶</a></dt>
<dd><p>Change sharpness of image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">change_sharpness</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="go">array([[255,   0,   0],</span>
<span class="go">       [  0, 196,   0],</span>
<span class="go">       [  0,   0, 255]], dtype=uint8)</span>
</pre></div>
</div>
<p>See
<a class="reference external" href="http://pillow.readthedocs.io/en/3.1.x/reference/ImageEnhance.html#PIL.ImageEnhance.Sharpness">http://pillow.readthedocs.io/en/3.1.x/reference/ImageEnhance.html#PIL.ImageEnhance.Sharpness</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</li>
<li><strong>sharpness</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Sharpness [0, …]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Image with changed sharpness</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with range [0,255] and dtype ‘uint8’</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.crop">
<code class="descname">crop</code><span class="sig-paren">(</span><em>image</em>, <em>x1</em>, <em>y1</em>, <em>x2</em>, <em>y2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#crop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crop</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">array([[ 9, 10, 11],</span>
<span class="go">       [13, 14, 15]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array.</li>
<li><strong>x1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – x-coordinate of left upper corner of crop (inclusive)</li>
<li><strong>y1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – y-coordinate of left upper corner of crop (inclusive)</li>
<li><strong>x2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – x-coordinate of right lower corner of crop (exclusive)</li>
<li><strong>y2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – y-coordinate of right lower corner of crop (exclusive)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Cropped image</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.crop_center">
<code class="descname">crop_center</code><span class="sig-paren">(</span><em>image</em>, <em>w</em>, <em>h</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#crop_center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.crop_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop region with size w, h from center of image.</p>
<p>Note that the crop is specified via w, h and not via shape (h,w).
Furthermore if the image or the crop region have even dimensions,
coordinates are rounded down.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crop_center</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">array([[ 4,  5,  6],</span>
<span class="go">       [ 8,  9, 10]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array.</li>
<li><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Width of crop</li>
<li><strong>h</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Height of crop</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Cropped image</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">numpy array</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raise:</th><td class="field-body"><p class="first last">ValueError if image is smaller than crop region</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.crop_square">
<code class="descname">crop_square</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#crop_square"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.crop_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop image to square shape.</p>
<p>Crops symmetrically left and right or top and bottom to achieve
aspect ratio of one and preserves the largest dimension.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array image</strong> (<em>numpy</em>) – Numpy array.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Cropped image</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.distort_elastic">
<code class="descname">distort_elastic</code><span class="sig-paren">(</span><em>image</em>, <em>smooth=10.0</em>, <em>scale=100.0</em>, <em>seed=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#distort_elastic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.distort_elastic" title="Permalink to this definition">¶</a></dt>
<dd><p>Elastic distortion of images.</p>
<p>Channel axis in RGB images will not be distorted but grayscale or
RGB images are both valid inputs. RGB and grayscale images will be
distorted identically for the same seed.</p>
<p>Simard, et. al, “Best Practices for Convolutional Neural Networks
applied to Visual Document Analysis”,
in Proc. of the International Conference on Document Analysis and
Recognition, 2003.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>ndarray</em>) – Image of shape [h,w] or [h,w,c]</li>
<li><strong>smooth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Smoothes the distortion.</li>
<li><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Scales the distortion.</li>
<li><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Seed for random number generator. Ensures that for the
same seed images are distorted identically.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Distorted image with same shape as input image.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.enhance">
<code class="descname">enhance</code><span class="sig-paren">(</span><em>image</em>, <em>func</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#enhance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.enhance" title="Permalink to this definition">¶</a></dt>
<dd><p>Enhance image using a PIL enhance function</p>
<p>See the following link for details on PIL enhance functions:
<a class="reference external" href="http://pillow.readthedocs.io/en/3.1.x/reference/ImageEnhance.html">http://pillow.readthedocs.io/en/3.1.x/reference/ImageEnhance.html</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">PIL.ImageEnhance</span> <span class="k">import</span> <span class="n">Brightness</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">enhance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">Brightness</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="go">array([[0, 0],</span>
<span class="go">       [0, 0],</span>
<span class="go">       [0, 0]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</li>
<li><strong>func</strong> (<em>function</em>) – PIL ImageEnhance function</li>
<li><strong>args</strong> (<em>args</em>) – Argument list passed on to enhance function.</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Key-word arguments passed on to enhance function</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Enhanced image</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with range [0,255] and dtype ‘uint8’</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.extract_patch">
<code class="descname">extract_patch</code><span class="sig-paren">(</span><em>image</em>, <em>pshape</em>, <em>r</em>, <em>c</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#extract_patch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.extract_patch" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract a patch of given shape, centered at r,c of given shape from image.</p>
<p>Note that there is no checking if the patch region is inside the image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extract_patch</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">array([[ 5,  6,  7],</span>
<span class="go">       [ 9, 10, 11]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.
Can be of shapes MxN, MxNxC.</li>
<li><strong>pshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Shape of patch. #Dimensions must match image.</li>
<li><strong>r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Row for center of patch</li>
<li><strong>c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Column for center of patch</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array with shape pshape</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with range [0,255] and dtype ‘uint8’</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.fliplr">
<code class="descname">fliplr</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#fliplr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.fliplr" title="Permalink to this definition">¶</a></dt>
<dd><p>Flip image left to right.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fliplr</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="go">array([[1, 0],</span>
<span class="go">       [3, 2]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Flipped image</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy array with range [0,255] and dtype ‘uint8’</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.flipud">
<code class="descname">flipud</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#flipud"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.flipud" title="Permalink to this definition">¶</a></dt>
<dd><p>Flip image up to down.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flipud</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="go">array([[2, 3],</span>
<span class="go">       [0, 1]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Flipped image</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy array with range [0,255] and dtype ‘uint8’</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.floatimg2uint8">
<code class="descname">floatimg2uint8</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#floatimg2uint8"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.floatimg2uint8" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert array with floats to ‘uint8’ and rescale from [0,1] to [0, 256].</p>
<p>Converts only if image.dtype != uint8.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">floatimg2uint8</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">255</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<em>numpy.array</em>) – Numpy array with range [0,1]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Numpy array with range [0,255] and dtype ‘uint8’</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.gray2rgb">
<code class="descname">gray2rgb</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#gray2rgb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.gray2rgb" title="Permalink to this definition">¶</a></dt>
<dd><p>Grayscale scale image to RGB image</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gray2rgb</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="go">array([[[255, 255, 255],</span>
<span class="go">        [  0,   0,   0],</span>
<span class="go">        [  0,   0,   0]],</span>

<span class="go">       [[  0,   0,   0],</span>
<span class="go">        [255, 255, 255],</span>
<span class="go">        [  0,   0,   0]],</span>

<span class="go">       [[  0,   0,   0],</span>
<span class="go">        [  0,   0,   0],</span>
<span class="go">        [255, 255, 255]]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">RGB image</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy array with range [0,255] and dtype ‘uint8’</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.identical">
<code class="descname">identical</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#identical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.identical" title="Permalink to this definition">¶</a></dt>
<dd><p>Return input image unchanged.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<em>numpy.array</em>) – Should be a numpy array of an image.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Same as input</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Same as input</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.load_image">
<code class="descname">load_image</code><span class="sig-paren">(</span><em>filepath</em>, <em>as_grey=False</em>, <em>dtype='uint8'</em>, <em>no_alpha=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#load_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.load_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Load image as numpy array from given filepath.</p>
<p>Supported formats: gif, png, jpg, bmp, tif, npy</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">load_image</span><span class="p">(</span><span class="s1">&#39;tests/data/img_formats/nut_color.jpg&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapestr</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="go">&#39;213x320x3&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filepath</strong> (<em>string</em>) – Filepath to image file or numpy array.</li>
<li><strong>as_grey</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array with shapes
(h, w) for grayscale or monochrome,
(h, w, 3) for RGB (3 color channels in last axis)
(h, w, 4) for RGBA (for no_alpha = False)
(h, w, 3) for RGBA (for no_alpha = True)
pixel values are in range [0,255] for dtype = uint8</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.mask_choice">
<code class="descname">mask_choice</code><span class="sig-paren">(</span><em>mask</em>, <em>value</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#mask_choice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.mask_choice" title="Permalink to this definition">¶</a></dt>
<dd><p>Random selection of n points where mask has given value</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># ensure same random selection for doctest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_choice</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="go">[[0, 0], [2, 2]]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array mask</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of points to select. If n is larger than the
points available only the available points will be returned.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Array with x,y coordinates</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with shape nx2 where each row contains x, y</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.mask_where">
<code class="descname">mask_where</code><span class="sig-paren">(</span><em>mask</em>, <em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#mask_where"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.mask_where" title="Permalink to this definition">¶</a></dt>
<dd><p>Return x,y coordinates where mask has specified value</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask_where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="go">[[0, 0], [1, 1], [2, 2]]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array mask</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Array with x,y coordinates</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy array with shape Nx2 where each row contains x, y</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.normalize_histo">
<code class="descname">normalize_histo</code><span class="sig-paren">(</span><em>image</em>, <em>gamma=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#normalize_histo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.normalize_histo" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform histogram normalization on image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</li>
<li><strong>gamma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Factor for gamma adjustment.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Normalized image</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with range [0,255] and dtype ‘uint8’</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.occlude">
<code class="descname">occlude</code><span class="sig-paren">(</span><em>image</em>, <em>x</em>, <em>y</em>, <em>w</em>, <em>h</em>, <em>color=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#occlude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.occlude" title="Permalink to this definition">¶</a></dt>
<dd><p>Occlude image with a rectangular region.</p>
<p>Occludes an image region with dimensions w,h centered on x,y with the
given color. Invalid x,y coordinates will be clipped to ensure complete
occlusion rectangle is within the image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">occlude</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">array([[1, 1, 1, 1, 1],</span>
<span class="go">       [1, 0, 0, 1, 1],</span>
<span class="go">       [1, 0, 0, 1, 1],</span>
<span class="go">       [1, 0, 0, 1, 1]], dtype=uint8)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">occlude</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="go">array([[1, 1, 1, 1],</span>
<span class="go">       [1, 0, 0, 1],</span>
<span class="go">       [1, 0, 0, 1],</span>
<span class="go">       [1, 1, 1, 1]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array.</li>
<li><strong>x</strong> (<em>int|float</em>) – x coordinate for center of occlusion region.
Can be provided as fraction (float) of image width</li>
<li><strong>y</strong> (<em>int|float</em>) – y coordinate for center of occlusion region.
Can be provided as fraction (float) of image height</li>
<li><strong>w</strong> (<em>int|float</em>) – width of occlusion region.
Can be provided as fraction (float) of image width</li>
<li><strong>h</strong> (<em>int|float</em>) – height of occlusion region.
Can be provided as fraction (float) of image height</li>
<li><strong>color</strong> (<em>int|tuple</em>) – gray-scale or RGB color of occlusion.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Copy of input image with occluded region.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.patch_iter">
<code class="descname">patch_iter</code><span class="sig-paren">(</span><em>image</em>, <em>shape=(3</em>, <em>3)</em>, <em>stride=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#patch_iter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.patch_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts patches from images with given shape.</p>
<p>Patches are extracted in a regular grid with the given stride,
starting in the left upper corner and then row-wise.
Image can be gray-scale (no third channel dim) or color.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">patch_iter</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">[[0 1]</span>
<span class="go"> [4 5]]</span>
<span class="go">[[2 3]</span>
<span class="go"> [6 7]]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>ndarray</em>) – Numpy array of shape h,w,c or h,w.</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Shape of patch (h,w)</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Step size of grid patches are extracted from</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Iterator over patches</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Iterator</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.pil_to_arr">
<code class="descname">pil_to_arr</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#pil_to_arr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.pil_to_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert PIL image to Numpy array.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pil_img</span> <span class="o">=</span> <span class="n">arr_to_pil</span><span class="p">(</span><span class="n">rgb_arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">pil_to_arr</span><span class="p">(</span><span class="n">pil_img</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapestr</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">&#39;5x4x3&#39;</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<em>PIL.Image</em>) – PIL image (RGB or grayscale)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Numpy array</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.array with dtype ‘uint8’</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.polyline2coords">
<code class="descname">polyline2coords</code><span class="sig-paren">(</span><em>points</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#polyline2coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.polyline2coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return row and column coordinates for a polyline.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rr</span><span class="p">,</span> <span class="n">cc</span> <span class="o">=</span> <span class="n">polyline2coords</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">rr</span><span class="p">)</span>
<span class="go">[0, 1, 2, 2, 3, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
<span class="go">[0, 1, 2, 2, 2, 2]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>of tuple points</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – Polyline in format [(x1,y1), (x2,y2), …]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tuple with row and column coordinates in numpy arrays</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">tuple of numpy array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.rerange">
<code class="descname">rerange</code><span class="sig-paren">(</span><em>image</em>, <em>old_min</em>, <em>old_max</em>, <em>new_min</em>, <em>new_max</em>, <em>dtype</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#rerange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.rerange" title="Permalink to this definition">¶</a></dt>
<dd><p>Return image with values in new range.</p>
<p>Note: The default range of images is [0, 255] and most image
processing functions expect this range and will fail otherwise.
However, as input to neural networks re-ranged images, e.g [-1, +1]
are sometimes needed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">],</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rerange</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;float32&#39;</span><span class="p">)</span>
<span class="go">array([[-1.,  1.],</span>
<span class="go">       [ 1., -1.]], dtype=float32)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>image</strong> (<em>numpy.array</em>) – Should be a numpy array of an image.</li>
<li><strong>old_min</strong> (<em>int|float</em>) – Current minimum value of image, e.g. 0</li>
<li><strong>old_max</strong> (<em>int|float</em>) – Current maximum value of image, e.g. 255</li>
<li><strong>new_min</strong> (<em>int|float</em>) – New minimum, e.g. -1.0</li>
<li><strong>new_max</strong> (<em>int|float</em>) – New maximum, e.g. +1.0</li>
<li><strong>datatype dtype</strong> (<em>numpy</em>) – Data type of output image,
e.g. float32’ or np.uint8</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Image with values in new range.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.resize">
<code class="descname">resize</code><span class="sig-paren">(</span><em>image</em>, <em>w</em>, <em>h</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#resize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize image.</p>
<p>Image can be up- or down-sized (using interpolation). For details see:
<a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.resize">http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.resize</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resize</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">array([[1, 1, 1, 1],</span>
<span class="go">       [1, 1, 1, 1],</span>
<span class="go">       [1, 1, 1, 1]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</li>
<li><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Width in pixels.</li>
<li><strong>h</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Height in pixels.</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Keyword arguments for the underlying scikit-image
resize function, e.g. order=1 for linear interpolation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Resized image</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with range [0,255] and dtype ‘uint8’</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.rgb2gray">
<code class="descname">rgb2gray</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#rgb2gray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.rgb2gray" title="Permalink to this definition">¶</a></dt>
<dd><p>RGB scale image to grayscale image</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rgb2gray</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="go">array([[255,   0,   0],</span>
<span class="go">       [  0, 255,   0],</span>
<span class="go">       [  0,   0, 255]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">grayscale image</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy array with range [0,255] and dtype ‘uint8’</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>image</em>, <em>angle=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate image.</p>
<p>For details see:
<a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.rotate">http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.rotate</a></p>
<p>For a smooth interpolation of images set ‘order=1’. To rotate masks use
the default ‘order=0’.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotate</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="go">array([[0, 0, 1],</span>
<span class="go">       [0, 1, 0],</span>
<span class="go">       [1, 0, 0]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</li>
<li><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Angle in degrees in counter-clockwise direction</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Keyword arguments for the underlying scikit-image
rotate function, e.g. order=1 for linear interpolation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Rotated image</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with range [0,255] and dtype ‘uint8’</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.sample_labeled_patch_centers">
<code class="descname">sample_labeled_patch_centers</code><span class="sig-paren">(</span><em>mask</em>, <em>value</em>, <em>pshape</em>, <em>n</em>, <em>label</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#sample_labeled_patch_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.sample_labeled_patch_centers" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly pick n points in mask where mask has given value and add label.</p>
<p>Same as imageutil.sample_mask but adds given label to each center</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_labeled_patch_centers</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">array([[1, 2, 0]], dtype=uint16)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mask</strong> (<em>ndarray</em>) – Mask</li>
<li><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Sample points in mask that have this value.</li>
<li><strong>pshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Patch shape of form (h,w)</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of points to sample. If there is not enough points
to sample from a smaller number will be returned. If there are not
points at all np.empty((0, 2)) will be returned.</li>
<li><strong>label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Numeric label to append to each center point</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Center points of patches within the mask where the center point
has the given mask value and the label</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray of shape (n, 3)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.sample_mask">
<code class="descname">sample_mask</code><span class="sig-paren">(</span><em>mask</em>, <em>value</em>, <em>pshape</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#sample_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.sample_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly pick n points in mask where mask has given value.</p>
<p>Ensure that only points picked that can be center of a patch with
shape pshape that is inside the mask.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">array([[1, 2]], dtype=uint16)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mask</strong> (<em>ndarray</em>) – Mask</li>
<li><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Sample points in mask that have this value.</li>
<li><strong>pshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Patch shape of form (h,w)</li>
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of points to sample. If there is not enough points
to sample from a smaller number will be returned. If there are not
points at all np.empty((0, 2)) will be returned.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Center points of patches within the mask where the center point
has the given mask value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray of shape (n, 2)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.sample_patch_centers">
<code class="descname">sample_patch_centers</code><span class="sig-paren">(</span><em>mask</em>, <em>pshape</em>, <em>npos</em>, <em>nneg</em>, <em>pos=255</em>, <em>neg=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#sample_patch_centers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.sample_patch_centers" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample positive and negative patch centers where mask value is pos or neg.</p>
<p>The sampling routine ensures that the patch is completely inside the mask.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>   <span class="c1"># just to ensure consistent doctest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_patch_centers</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">array([[1, 1, 0],</span>
<span class="go">       [1, 2, 1]], dtype=uint16)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mask</strong> (<em>ndarray</em>) – Mask</li>
<li><strong>pshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Patch shape of form (h,w)</li>
<li><strong>npos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of positives to sample.</li>
<li><strong>nneg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of negatives to sample.</li>
<li><strong>pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Value for positive points in mask</li>
<li><strong>neg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Value for negative points in mask</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Center points of patches within the mask where the center point
has the given mask value (pos, neg) and the label (1, 0)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray of shape (n, 3)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.sample_pn_patches">
<code class="descname">sample_pn_patches</code><span class="sig-paren">(</span><em>image</em>, <em>mask</em>, <em>pshape</em>, <em>npos</em>, <em>nneg</em>, <em>pos=255</em>, <em>neg=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#sample_pn_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.sample_pn_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample positive and negative patches where mask value is pos or neg.</p>
<p>The sampling routine ensures that the patch is completely inside the
image and mask and that a patch a the same position is extracted from
the image and the mask.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>   <span class="c1"># just to ensure consistent doctest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ip</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">sample_pn_patches</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="go">[[0 1]</span>
<span class="go"> [4 5]]</span>
<span class="go">[[0 0]</span>
<span class="go"> [0 0]]</span>
<span class="go">0</span>
<span class="go">[[1 2]</span>
<span class="go"> [5 6]]</span>
<span class="go">[[  0   0]</span>
<span class="go"> [  0 255]]</span>
<span class="go">1</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mask</strong> (<em>ndarray</em>) – Mask</li>
<li><strong>pshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Patch shape of form (h,w)</li>
<li><strong>npos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of positives to sample.</li>
<li><strong>nneg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of negatives to sample.</li>
<li><strong>pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Value for positive points in mask</li>
<li><strong>neg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Value for negative points in mask</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Image and mask patches where the patch center point
has the given mask value (pos, neg) and the label (1, 0)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a>(image_patch, mask_patch, label)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.save_image">
<code class="descname">save_image</code><span class="sig-paren">(</span><em>filepath</em>, <em>image</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#save_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.save_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Save numpy array as image (or numpy array) to given filepath.</p>
<p>Supported formats: gif, png, jpg, bmp, tif, npy</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filepath</strong> (<em>string</em>) – File path for image file. Extension determines
image file format, e.g. .gif</li>
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array to save as image.
Must be of shape (h,w) or (h,w,3) or (h,w,4)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.set_default_order">
<code class="descname">set_default_order</code><span class="sig-paren">(</span><em>kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#set_default_order"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.set_default_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Set order parameter in kwargs for scikit-image functions.</p>
<p>Default order is 1, which performs a linear interpolation of pixel values
when images are rotated, resized and sheared. This is fine for images
but causes unwanted pixel values in masks. This function set the default
order to 0, which disables the interpolation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kwargs</strong> (<em>kwargs</em>) – Dictionary with keyword arguments.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.shear">
<code class="descname">shear</code><span class="sig-paren">(</span><em>image</em>, <em>shear_factor</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#shear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.shear" title="Permalink to this definition">¶</a></dt>
<dd><p>Shear image.</p>
<p>For details see:
<a class="reference external" href="http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.AffineTransform">http://scikit-image.org/docs/dev/api/skimage.transform.html#skimage.transform.AffineTransform</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotated</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</li>
<li><strong>shear_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Shear factor [0, 1]</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Keyword arguments for the underlying scikit-image
warp function, e.g. order=1 for linear interpolation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Sheared image</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with range [0,255] and dtype ‘uint8’</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="nutsml.imageutil.translate">
<code class="descname">translate</code><span class="sig-paren">(</span><em>image</em>, <em>dx</em>, <em>dy</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/imageutil.html#translate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.imageutil.translate" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift image horizontally and vertically</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">translate</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">array([[  0,   0,   0],</span>
<span class="go">       [  0,   0, 255],</span>
<span class="go">       [  0,   0,   0]], dtype=uint8)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array image</strong> (<em>numpy</em>) – Numpy array with range [0,255] and dtype ‘uint8’.</li>
<li><strong>dx</strong> – horizontal translation in pixels</li>
<li><strong>dy</strong> – vertical translation in pixels</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Keyword arguments for the underlying scikit-image
rotate function, e.g. order=1 for linear interpolation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">translated image</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array with range [0,255] and dtype ‘uint8’</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-nutsml.logger">
<span id="nutsml-logger-module"></span><h2>nutsml.logger module<a class="headerlink" href="#module-nutsml.logger" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-logger"></span><dl class="class">
<dt id="nutsml.logger.LogCols">
<em class="property">class </em><code class="descname">LogCols</code><span class="sig-paren">(</span><em>filepath</em>, <em>cols=None</em>, <em>colnames=None</em>, <em>reset=True</em>, <em>delimiter='</em>, <em>'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/logger.html#LogCols"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.logger.LogCols" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#nutsml.logger.LogToFile" title="nutsml.logger.LogToFile"><code class="xref py py-class docutils literal notranslate"><span class="pre">nutsml.logger.LogToFile</span></code></a></p>
<dl class="method">
<dt id="nutsml.logger.LogCols.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>filepath</em>, <em>cols=None</em>, <em>colnames=None</em>, <em>reset=True</em>, <em>delimiter='</em>, <em>'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/logger.html#LogCols.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.logger.LogCols.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct logger.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Consume</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="s1">&#39;tests/data/temp_logfile.csv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">LogToFile</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">logtofile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">data</span> <span class="o">&gt;&gt;</span> <span class="n">logtofile</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">1,2</span>
<span class="go">3,4</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logtofile</span> <span class="o">=</span> <span class="n">LogToFile</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">&gt;&gt;</span> <span class="n">logtofile</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">a,b</span>
<span class="go">2,1</span>
<span class="go">4,3</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">logtofile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logtofile</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filepath</strong> (<em>string</em>) – Path to file to write log to.</li>
<li><strong>cols</strong> (<em>int|tuple|None</em>) – Indices of columns of input data to write.
None: write all columns
int: only write the single given column
tuple: list of column indices</li>
<li><strong>colnames</strong> (<em>tuple|None</em>) – Column names to write in first line.
If None no colnames are written.</li>
<li><strong>reset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – If True the writing to the log file is reset
if the logger is recreated. Otherwise log data is appended
to the log file.</li>
<li><strong>delimiter</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Delimiter for columns in log file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.logger.LogToFile">
<em class="property">class </em><code class="descname">LogToFile</code><span class="sig-paren">(</span><em>filepath</em>, <em>cols=None</em>, <em>colnames=None</em>, <em>reset=True</em>, <em>delimiter='</em>, <em>'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/logger.html#LogToFile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.logger.LogToFile" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Log columns of data to file.</p>
<dl class="method">
<dt id="nutsml.logger.LogToFile.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/logger.html#LogToFile.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.logger.LogToFile.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Log x</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>any</em>) – Any type of data.
Special support for numpy arrays.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Return input unchanged</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Same as input</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.logger.LogToFile.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>filepath</em>, <em>cols=None</em>, <em>colnames=None</em>, <em>reset=True</em>, <em>delimiter='</em>, <em>'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/logger.html#LogToFile.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.logger.LogToFile.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct logger.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Consume</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filepath</span> <span class="o">=</span> <span class="s1">&#39;tests/data/temp_logfile.csv&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">LogToFile</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">logtofile</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">data</span> <span class="o">&gt;&gt;</span> <span class="n">logtofile</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">1,2</span>
<span class="go">3,4</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">logtofile</span> <span class="o">=</span> <span class="n">LogToFile</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colnames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">&gt;&gt;</span> <span class="n">logtofile</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="go">a,b</span>
<span class="go">2,1</span>
<span class="go">4,3</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">logtofile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logtofile</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filepath</strong> (<em>string</em>) – Path to file to write log to.</li>
<li><strong>cols</strong> (<em>int|tuple|None</em>) – Indices of columns of input data to write.
None: write all columns
int: only write the single given column
tuple: list of column indices</li>
<li><strong>colnames</strong> (<em>tuple|None</em>) – Column names to write in first line.
If None no colnames are written.</li>
<li><strong>reset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – If True the writing to the log file is reset
if the logger is recreated. Otherwise log data is appended
to the log file.</li>
<li><strong>delimiter</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Delimiter for columns in log file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.logger.LogToFile.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/logger.html#LogToFile.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.logger.LogToFile.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of context manager API</p>
</dd></dl>

<dl class="method">
<dt id="nutsml.logger.LogToFile.delete">
<code class="descname">delete</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/logger.html#LogToFile.delete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.logger.LogToFile.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete log file</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nutsml.network">
<span id="nutsml-network-module"></span><h2>nutsml.network module<a class="headerlink" href="#module-nutsml.network" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-network"></span><dl class="class">
<dt id="nutsml.network.EvalNut">
<em class="property">class </em><code class="descname">EvalNut</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#EvalNut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.EvalNut" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutSink</span></code></p>
<p>batches &gt;&gt; EvalNut(network, metrics)</p>
<p>Create nut to evaluate network performance for given metrics.
Returned when network.evaluate() is called.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>over batches batches</strong> (<em>iterable</em>) – Batches to evaluate</li>
<li><strong>network</strong> (<em>nutmsml.Network</em>) – </li>
<li><strong>of functions metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of functions that compute
some metric, e.g. accuracy, F1, kappa-score.
Each metric function must take vectors with true and
predicted  classes/probabilities and must compute the
metric over the entire input (not per sample/mini-batch).</li>
<li><strong>compute</strong> (<em>function</em>) – Function of the form f(metric, targets, preds)
that computes the given metric (e.g. mean accuracy) for the given
targets and predictions.</li>
<li><strong>predcol</strong> (<em>int|None</em>) – Index of column in prediction to extract
for evaluation. If None a single prediction output is
expected.</li>
<li><strong>targetcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of batch column that contain targets.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Result(s) of evaluation, e.g. accuracy, precision, …</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a> or tuple of floats if there is more than one metric</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.network.EvalNut.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.network.EvalNut.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.network.KerasNetwork">
<em class="property">class </em><code class="descname">KerasNetwork</code><span class="sig-paren">(</span><em>model</em>, <em>weightspath='weights_keras_net.hd5'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#KerasNetwork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.KerasNetwork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#nutsml.network.Network" title="nutsml.network.Network"><code class="xref py py-class docutils literal notranslate"><span class="pre">nutsml.network.Network</span></code></a></p>
<p>Wrapper for Keras models: <a class="reference external" href="https://keras.io/">https://keras.io/</a></p>
<dl class="method">
<dt id="nutsml.network.KerasNetwork.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>model</em>, <em>weightspath='weights_keras_net.hd5'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#KerasNetwork.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.KerasNetwork.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct wrapper around Keras model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model model</strong> (<em>Keras</em>) – Keras model to wrap. See
<a class="reference external" href="https://keras.io/models/sequential/">https://keras.io/models/sequential/</a>
<a class="reference external" href="https://keras.io/models/model/">https://keras.io/models/model/</a></li>
<li><strong>weightspath</strong> (<em>string</em>) – Filepath to save/load model weights.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.KerasNetwork.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>metrics</em>, <em>predcol=None</em>, <em>targetcol=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#KerasNetwork.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.KerasNetwork.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate performance of network for given metrices</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">acc</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">evaluate</span><span class="p">([</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">])</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of metrics. See EvalNut for details.</li>
<li><strong>predcol</strong> (<em>int|None</em>) – Index of column in prediction to extract
for evaluation. If None a single prediction output is
expected.</li>
<li><strong>targetcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of batch column that contain targets.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result for each metric as a tuple or a single float if
there is only one metric.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.KerasNetwork.load_weights">
<code class="descname">load_weights</code><span class="sig-paren">(</span><em>weightspath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#KerasNetwork.load_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.KerasNetwork.load_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Load network weights.</p>
<div class="line-block">
<div class="line">network.load_weights()</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weightspath</strong> (<em>string</em>) – Path to network weights.
self.weightspath is used if weightspath is None.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.KerasNetwork.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>flatten=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#KerasNetwork.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.KerasNetwork.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get network predictions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flatten</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True: return individual predictions instead
of batch of prediction</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Typically returns softmax class probabilities.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.KerasNetwork.print_layers">
<code class="descname">print_layers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#KerasNetwork.print_layers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.KerasNetwork.print_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Print description of the network layers</p>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.KerasNetwork.save_weights">
<code class="descname">save_weights</code><span class="sig-paren">(</span><em>weightspath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#KerasNetwork.save_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.KerasNetwork.save_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Save network weights.</p>
<div class="line-block">
<div class="line">network.save_weights()</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weightspath</strong> (<em>string</em>) – Path to network weights.
self.weightspath is used if weightspath is None.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.KerasNetwork.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#KerasNetwork.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.KerasNetwork.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train network</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">train_losses</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">train</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Typically returns training loss per batch.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.KerasNetwork.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#KerasNetwork.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.KerasNetwork.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate network</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">val_losses</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Typically returns validation loss per batch.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.network.LasagneNetwork">
<em class="property">class </em><code class="descname">LasagneNetwork</code><span class="sig-paren">(</span><em>out_layer</em>, <em>train_fn</em>, <em>val_fn</em>, <em>pred_fn</em>, <em>weightspath='weights_lasagne_net.npz'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#LasagneNetwork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.LasagneNetwork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#nutsml.network.Network" title="nutsml.network.Network"><code class="xref py py-class docutils literal notranslate"><span class="pre">nutsml.network.Network</span></code></a></p>
<p>Wrapper for Lasagne models: <a class="reference external" href="https://lasagne.readthedocs.io/en/latest/">https://lasagne.readthedocs.io/en/latest/</a></p>
<dl class="method">
<dt id="nutsml.network.LasagneNetwork.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>out_layer</em>, <em>train_fn</em>, <em>val_fn</em>, <em>pred_fn</em>, <em>weightspath='weights_lasagne_net.npz'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#LasagneNetwork.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.LasagneNetwork.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct wrapper around Lasagne network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>layer out_layer</strong> (<em>Lasgane</em>) – Output layer of Lasagne network.</li>
<li><strong>function train_fn</strong> (<em>Theano</em>) – Training function</li>
<li><strong>function val_fn</strong> (<em>Theano</em>) – Validation function</li>
<li><strong>function pred_fn</strong> (<em>Theano</em>) – Prediction function</li>
<li><strong>weightspath</strong> (<em>string</em>) – Filepath to save/load model weights.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.LasagneNetwork.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>metrics</em>, <em>predcol=None</em>, <em>targetcol=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#LasagneNetwork.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.LasagneNetwork.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate performance of network for given metrices</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">acc</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">evaluate</span><span class="p">([</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">])</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of metrics. See EvalNut for details.</li>
<li><strong>predcol</strong> (<em>int|None</em>) – Index of column in prediction to extract
for evaluation. If None a single prediction output is
expected.</li>
<li><strong>targetcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of batch column that contain targets.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result for each metric as a tuple or a single float if
there is only one metric.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.LasagneNetwork.load_weights">
<code class="descname">load_weights</code><span class="sig-paren">(</span><em>weightspath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#LasagneNetwork.load_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.LasagneNetwork.load_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Load network weights.</p>
<div class="line-block">
<div class="line">network.load_weights()</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weightspath</strong> (<em>string</em>) – Path to network weights.
self.weightspath is used if weightspath is None.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.LasagneNetwork.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>flatten=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#LasagneNetwork.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.LasagneNetwork.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get network predictions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flatten</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True: return individual predictions instead
of batch of prediction</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Typically returns softmax class probabilities.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.LasagneNetwork.print_layers">
<code class="descname">print_layers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#LasagneNetwork.print_layers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.LasagneNetwork.print_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Print description of the network layers</p>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.LasagneNetwork.save_weights">
<code class="descname">save_weights</code><span class="sig-paren">(</span><em>weightspath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#LasagneNetwork.save_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.LasagneNetwork.save_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Save network weights.</p>
<div class="line-block">
<div class="line">network.save_weights()</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weightspath</strong> (<em>string</em>) – Path to network weights.
self.weightspath is used if weightspath is None.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.LasagneNetwork.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#LasagneNetwork.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.LasagneNetwork.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train network</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">train_losses</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">train</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Typically returns training loss per batch.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.LasagneNetwork.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#LasagneNetwork.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.LasagneNetwork.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate network</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">val_losses</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Typically returns validation loss per batch.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.network.Network">
<em class="property">class </em><code class="descname">Network</code><span class="sig-paren">(</span><em>weightspath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#Network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.Network" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Abstract base class for networks. Allows to wrap existing network APIs
such as Lasagne or Keras into an API that enables direct usage of the
network as a Nut in a nuts flow.</p>
<dl class="method">
<dt id="nutsml.network.Network.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>weightspath</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#Network.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.Network.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs base wrapper for networks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weightspath</strong> (<em>string</em>) – Filepath where network weights are saved to
and loaded from.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.Network.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>metrics</em>, <em>predcol=None</em>, <em>targetcol=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#Network.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.Network.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate performance of network for given metrices</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">acc</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">evaluate</span><span class="p">([</span><span class="n">accuracy</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">])</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of metrics. See EvalNut for details.</li>
<li><strong>predcol</strong> (<em>int|None</em>) – Index of column in prediction to extract
for evaluation. If None a single prediction output is
expected.</li>
<li><strong>targetcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of batch column that contain targets.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Result for each metric as a tuple or a single float if
there is only one metric.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.Network.load_weights">
<code class="descname">load_weights</code><span class="sig-paren">(</span><em>weightspath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#Network.load_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.Network.load_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Load network weights.</p>
<div class="line-block">
<div class="line">network.load_weights()</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weightspath</strong> (<em>string</em>) – Path to network weights.
self.weightspath is used if weightspath is None.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.Network.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>flatten=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#Network.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.Network.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get network predictions</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>flatten</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True: return individual predictions instead
of batch of prediction</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Typically returns softmax class probabilities.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.Network.print_layers">
<code class="descname">print_layers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#Network.print_layers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.Network.print_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Print description of the network layers</p>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.Network.save_best">
<code class="descname">save_best</code><span class="sig-paren">(</span><em>score</em>, <em>isloss=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#Network.save_best"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.Network.save_best" title="Permalink to this definition">¶</a></dt>
<dd><p>Save weights of best network</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>score</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Score of the network, e.g. loss, accuracy</li>
<li><strong>isloss</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True means lower score is better, e.g. loss
and the network with the lower score score is saved.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.Network.save_weights">
<code class="descname">save_weights</code><span class="sig-paren">(</span><em>weightspath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#Network.save_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.Network.save_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Save network weights.</p>
<div class="line-block">
<div class="line">network.save_weights()</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>weightspath</strong> (<em>string</em>) – Path to network weights.
self.weightspath is used if weightspath is None.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.Network.train">
<code class="descname">train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#Network.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.Network.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train network</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">train_losses</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">train</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Typically returns training loss per batch.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.network.Network.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#Network.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.Network.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Validate network</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">val_losses</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">batcher</span> <span class="o">&gt;&gt;</span> <span class="n">network</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Typically returns validation loss per batch.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.network.PredictNut">
<em class="property">class </em><code class="descname">PredictNut</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#PredictNut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.PredictNut" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.Nut</span></code></p>
<p>batches &gt;&gt; PredictNut(func)</p>
<p>Create nut to perform network predictions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>over batches batches</strong> (<em>iterable</em>) – Batches to create predictions for.</li>
<li><strong>func</strong> (<em>function</em>) – Prediction function</li>
<li><strong>flatten</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True: flatten output. Instead of returning batch of
predictions return individual predictions</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Result(s) of prediction</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">typically array with class probabilities (softmax vector)</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.network.PredictNut.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.network.PredictNut.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.network.TrainValNut">
<em class="property">class </em><code class="descname">TrainValNut</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/network.html#TrainValNut"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.network.TrainValNut" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.Nut</span></code></p>
<p>batches &gt;&gt; TrainValNut(func, <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs)</p>
<p>Create nut to train or validate a network.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>over batches batches</strong> (<em>iterable</em>) – Batches to train/validate.</li>
<li><strong>func</strong> (<em>function</em>) – Training or validation function of network.</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Keyword arguments passed on to function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Result(s) of training/validation function, e.g. loss, accuracy, …</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a> or array/tuple of floats</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.network.TrainValNut.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.network.TrainValNut.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nutsml.plotter">
<span id="nutsml-plotter-module"></span><h2>nutsml.plotter module<a class="headerlink" href="#module-nutsml.plotter" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-plotter"></span><dl class="class">
<dt id="nutsml.plotter.PlotLines">
<em class="property">class </em><code class="descname">PlotLines</code><span class="sig-paren">(</span><em>ycols</em>, <em>xcols=None</em>, <em>layout=(1</em>, <em>None)</em>, <em>titles=None</em>, <em>every_sec=0</em>, <em>every_n=0</em>, <em>filterfunc=&lt;function PlotLines.&lt;lambda&gt;&gt;</em>, <em>figsize=None</em>, <em>filepath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/plotter.html#PlotLines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.plotter.PlotLines" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Plot line graph for selected data columns.</p>
<dl class="method">
<dt id="nutsml.plotter.PlotLines.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/plotter.html#PlotLines.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.plotter.PlotLines.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot data</p>
</dd></dl>

<dl class="method">
<dt id="nutsml.plotter.PlotLines.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>ycols</em>, <em>xcols=None</em>, <em>layout=(1</em>, <em>None)</em>, <em>titles=None</em>, <em>every_sec=0</em>, <em>every_n=0</em>, <em>filterfunc=&lt;function PlotLines.&lt;lambda&gt;&gt;</em>, <em>figsize=None</em>, <em>filepath=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/plotter.html#PlotLines.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.plotter.PlotLines.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>iterable &gt;&gt; PlotLines(ycols) &gt;&gt; Consume()</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Consume</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span> <span class="o">=</span> <span class="s1">&#39;tests/data/temp_plotter.png&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.3</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ysin</span><span class="p">,</span> <span class="n">ycos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span>  <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ysin</span><span class="p">,</span> <span class="n">ycos</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">&gt;&gt;</span> <span class="n">PlotLines</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">filepath</span><span class="o">=</span><span class="n">fp</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">ycos</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">PlotLines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">filepath</span><span class="o">=</span><span class="n">fp</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">&gt;&gt;</span> <span class="n">PlotLines</span><span class="p">(</span><span class="n">ycols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">filepath</span><span class="o">=</span><span class="n">fp</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ysin</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">PlotLines</span><span class="p">(</span><span class="n">ycols</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filepath</span><span class="o">=</span><span class="n">fp</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fp</span><span class="p">):</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ycols</strong> (<em>int|tuple|None</em>) – Index or tuple of indices of the 
data columns that contain the y-data for the plot.
If None data is used directly.</li>
<li><strong>xcols</strong> (<em>int|tuple|function|iterable|None</em>) – Index or tuple of indices
of the data columns that contain the x-data for the plot.
Alternatively an iterator or a function can be provided that
generates the x-data for the plot, e.g. xcols = itertools.count()
or xcols = lambda: epoch
For xcols==None, itertools.count() will be used.</li>
<li><strong>layout</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Rows and columns of the plotter layout., e.g.
a layout of (2,3) means that 6 plots in the data are
arranged in 2 rows and 3 columns.
Number of cols can be None is then derived from ycols</li>
<li><strong>every_sec</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Plot every given second, e.g. to plot
every 2.5 sec every_sec = 2.5</li>
<li><strong>every_n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Plot every n-th call.</li>
<li><strong>filterfunc</strong> (<em>function</em>) – Boolean function to filter plot data.</li>
<li><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Figure size in inch.</li>
<li><strong>filepath</strong> – Path to a file to draw plot to. If provided the
plot will not appear on the screen.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Returns input unaltered</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">any</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.plotter.PlotLines.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/plotter.html#PlotLines.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.plotter.PlotLines.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset plot data</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nutsml.reader">
<span id="nutsml-reader-module"></span><h2>nutsml.reader module<a class="headerlink" href="#module-nutsml.reader" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-reader"></span><dl class="class">
<dt id="nutsml.reader.DplyToList">
<em class="property">class </em><code class="descname">DplyToList</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/reader.html#DplyToList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.reader.DplyToList" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Convert DplyDataframe to list.</p>
<p>See: <a class="reference external" href="https://github.com/dodger487/dplython">https://github.com/dodger487/dplython</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ReadPandas</span><span class="p">(</span><span class="n">fpath</span><span class="p">)</span><span class="o">.</span><span class="n">dplyr</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">DplyToList</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dplyframe</strong> (<em>DplyDataframe</em>) – Dataframe.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of dataframe rows</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list of tuples</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.reader.DplyToList.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>element</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.reader.DplyToList.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.reader.ReadImage">
<em class="property">class </em><code class="descname">ReadImage</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/reader.html#ReadImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.reader.ReadImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Load images for samples.</p>
<p>Loads images in jpg, gif, png, tif and bmp format.
Images are returned as numpy arrays of shape (h, w, c) or (h, w) for
color images or gray scale images respectively.
See nutsml.imageutil.load_image for details.</p>
<p>Note that the loaded images replace the image file name|path in the
sample. If the images file paths are directly proved (not as a tuple
sample) still tuples with the loaded image are returned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Consume</span><span class="p">,</span> <span class="n">Collect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsml</span> <span class="k">import</span> <span class="n">PrintColType</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">images</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tests/data/img_formats/nut_color.gif&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images</span> <span class="o">&gt;&gt;</span> <span class="n">ReadImage</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">PrintColType</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
<span class="go">item 0: &lt;tuple&gt;</span>
<span class="go">  0: &lt;ndarray&gt; shape:213x320x3 dtype:uint8 range:0..255</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;tests/data/img_formats/nut_color.gif&#39;</span><span class="p">,</span> <span class="s1">&#39;class0&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_samples</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">ReadImage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">imagepath</span> <span class="o">=</span> <span class="s1">&#39;tests/data/img_formats/*.jpg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;nut_color&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;nut_grayscale&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">ReadImage</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">imagepath</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">PrintColType</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
<span class="go">item 0: &lt;tuple&gt;</span>
<span class="go">  0: &lt;int&gt; 1</span>
<span class="go">  1: &lt;ndarray&gt; shape:213x320x3 dtype:uint8 range:0..248</span>
<span class="go">item 1: &lt;tuple&gt;</span>
<span class="go">  0: &lt;int&gt; 2</span>
<span class="go">  1: &lt;ndarray&gt; shape:213x320 dtype:uint8 range:18..235</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pathfunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sample</span><span class="p">:</span> <span class="s1">&#39;tests/data/img_formats/</span><span class="si">{1}</span><span class="s1">.jpg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">sample</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_samples</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">ReadImage</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pathfunc</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sample</strong> (<em>tuple|list</em>) – (‘nut_color’, 1)</li>
<li><strong>columns</strong> (<em>None|int|tuple</em>) – Indices of columns in sample to be replaced
by image (based on image id in that column)
If None then a flat samples is assumed and
a tuple with the image is returned.</li>
<li><strong>pathfunc</strong> (<em>string|function|None</em>) – Filepath with wildcard ‘*’,
which is replaced by the imageid provided in the sample, e.g.
‘tests/data/img_formats/<a href="#id5"><span class="problematic" id="id6">*</span></a>.jpg’ for sample (‘nut_grayscale’, 2)
will become ‘tests/data/img_formats/nut_grayscale.jpg’
or
Function to compute path to image file from sample, e.g.
lambda sample: ‘tests/data/img_formats/{1}.jpg’.format(<a href="#id7"><span class="problematic" id="id8">*</span></a>sample)
or
None, in this case the image id is take as filepath.</li>
<li><strong>as_grey</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – If true, load as grayscale image.</li>
<li><strong>dtype</strong> (<em>dtype</em>) – Numpy data type of the image.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Sample with image ids replaced by image (=ndarray)
of shape (h, w, c) or (h, w)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.reader.ReadImage.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>element</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.reader.ReadImage.__call__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.reader.ReadLabelDirs">
<em class="property">class </em><code class="descname">ReadLabelDirs</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/reader.html#ReadLabelDirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.reader.ReadLabelDirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutSource</span></code></p>
<p>Read file paths from label directories.</p>
<p>Typically used when classification data is organized in folders,
where the folder name represents the class label and the files in
the folder the data samples (images, documents, …) for that class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Collect</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">read</span> <span class="o">=</span> <span class="n">ReadLabelDirs</span><span class="p">(</span><span class="s1">&#39;tests/data/labeldirs&#39;</span><span class="p">,</span> <span class="s1">&#39;*.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">read</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">(&#39;tests/data/labeldirs/0/test0.txt&#39;, &#39;0&#39;)</span>
<span class="go">(&#39;tests/data/labeldirs/1/test1.txt&#39;, &#39;1&#39;)</span>
<span class="go">(&#39;tests/data/labeldirs/1/test11.txt&#39;, &#39;1&#39;)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>basedir</strong> (<em>string</em>) – Path to folder that contains label directories.</li>
<li><strong>filepattern</strong> (<em>string</em>) – Pattern for filepaths to read from
label directories, e.g. ‘<em>.jpg’, ‘</em>.txt’</li>
<li><strong>exclude</strong> (<em>string</em>) – Pattern for label directories to exclude.
Default is ‘_*’ which excludes all label folders prefixed with ‘_’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">iterator over labeled file paths</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">iterator</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="nutsml.reader.ReadPandas">
<em class="property">class </em><code class="descname">ReadPandas</code><span class="sig-paren">(</span><em>filepath</em>, <em>rows=None</em>, <em>columns=None</em>, <em>dropnan=True</em>, <em>replacenan=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/reader.html#ReadPandas"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.reader.ReadPandas" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutSource</span></code></p>
<p>Read data as Pandas table from file system.</p>
<dl class="method">
<dt id="nutsml.reader.ReadPandas.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>filepath</em>, <em>rows=None</em>, <em>columns=None</em>, <em>dropnan=True</em>, <em>replacenan=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/reader.html#ReadPandas.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.reader.ReadPandas.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create reader for Pandas tables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Collect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ReadPandas</span><span class="p">(</span><span class="s1">&#39;tests/data/pandas_table.csv&#39;</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="go">[(1.0, 4.0), (3.0, 6.0)]</span>
</pre></div>
</div>
<p>Note that samples.dataframe contains the original Pandas dataframe and
any Pandas operations can be performed on it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">ReadPandas</span><span class="p">(</span><span class="s1">&#39;tests/data/pandas_table.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">   col1  col2</span>
<span class="go">0     1   4.0</span>
<span class="go">1     2   NaN</span>
<span class="go">2     3   6.0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">ReadPandas</span><span class="p">(</span><span class="s1">&#39;tests/data/pandas_table.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="go">[&#39;col1&#39;, &#39;col2&#39;]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Path to a table in CSV, TSV, XLSX or
Pandas pickle format. Depending of file extension (e.g. .csv)
the table format is picked.
Note tables must have a header with the column names or
use kwarg header=None</li>
<li><strong>rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Rows to filter. Any Pandas filter expression. If
rows = None all rows of the table are returned.</li>
<li><strong>columns</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of names for the table columns to return.
For columns = None all columns are returned.</li>
<li><strong>dropnan</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – If True all rows that contain NaN are dropped.</li>
<li><strong>replacenan</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><em>object</em></a>) – If not False all NaNs are replaced by
the value of replacenan</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Key word arguments passed on the the Pandas
methods for data reading, e.g, header=None.
See  pandas/pandas/io/parsers.py for detais</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.reader.ReadPandas.dply">
<code class="descname">dply</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/reader.html#ReadPandas.dply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.reader.ReadPandas.dply" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dplyr frame for the read table.</p>
<p>dplyr is an R inspired wrapper to process Pandas tables in a
flow-like manner. See <a class="reference external" href="https://github.com/dodger487/dplython">https://github.com/dodger487/dplython</a> and
<a class="reference external" href="https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html">https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html</a>
for more details about dplyr.</p>
<p>dplyr and nuts-ml use the same syntax (&gt;&gt;) for chaining functions and
integrate nicely with each other.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dplyr dataframe instead of Pandas dataframe.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">DplyFrame</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="nutsml.reader.ReadPandas.isnull">
<em class="property">static </em><code class="descname">isnull</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/reader.html#ReadPandas.isnull"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.reader.ReadPandas.isnull" title="Permalink to this definition">¶</a></dt>
<dd><p>Return true if values is NaN or None.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ReadPandas</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">NaN</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ReadPandas</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ReadPandas</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> – Value to test</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Return true for NaN or None values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)">bool</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nutsml.stratify">
<span id="nutsml-stratify-module"></span><h2>nutsml.stratify module<a class="headerlink" href="#module-nutsml.stratify" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-stratify"></span><dl class="class">
<dt id="nutsml.stratify.CollectStratified">
<em class="property">class </em><code class="descname">CollectStratified</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/stratify.html#CollectStratified"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.stratify.CollectStratified" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutSink</span></code></p>
<dl class="docutils">
<dt>iterable &gt;&gt; CollectStratified(labelcol, mode=’downrnd’,  container=list,</dt>
<dd>rand=rnd.Random())</dd>
</dl>
<p>Collects samples in a container and stratifies them by either randomly
down-sampling classes or up-sampling classes by duplicating samples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Collect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">CollectStratified</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Sort</span><span class="p">()</span>
<span class="go">[(&#39;neg&#39;, 0), (&#39;pos&#39;, 1)]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>over tuples iterable</strong> (<em>iterable</em>) – Iterable of tuples where column
labelcol contains a sample label that is used for stratification</li>
<li><strong>labelcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Column of tuple/samples that contains the label</li>
<li><strong>mode</strong> (<em>string</em>) – ‘downrnd’ : randomly down-sample
‘up’ : up-sample</li>
<li><strong>container</strong> (<em>container</em>) – Some container, e.g. list, set, dict
that can be filled from an iterable</li>
<li><strong>rand</strong> (<em>Random|None</em>) – Random number generator used for sampling.
If None, random.Random() is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Stratified samples</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">List of tuples</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.stratify.CollectStratified.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.stratify.CollectStratified.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.stratify.Stratify">
<em class="property">class </em><code class="descname">Stratify</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/stratify.html#Stratify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.stratify.Stratify" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.Nut</span></code></p>
<p>iterable &gt;&gt; Stratify(labelcol, labeldist, rand=rnd.Random())</p>
<p>Stratifies samples by randomly down-sampling according to the given
label distribution. In detail: samples belonging to the class with the
smallest number of samples are returned with probability one. Samples
from other classes are randomly down-sampled to match the number of
samples in the smallest class.</p>
<p>Note that in contrast to SplitRandom, which generates the same random
split per default, Stratify generates different stratifications.
Furthermore, while the downsampling is random the order of samples
remains the same!</p>
<p>While labeldist needs to be provided or computed upfront the actual
stratification occurs online and only one sample per time is stored
in memory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Collect</span><span class="p">,</span> <span class="n">CountValues</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow.common</span> <span class="k">import</span> <span class="n">StableRandom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fix</span> <span class="o">=</span> <span class="n">StableRandom</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Stable random numbers for doctest</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labeldist</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">CountValues</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">Stratify</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labeldist</span><span class="p">,</span> <span class="n">rand</span><span class="o">=</span><span class="n">fix</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Sort</span><span class="p">()</span>
<span class="go">[(&#39;neg&#39;, 0), (&#39;pos&#39;, 1)]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>over tuples iterable</strong> (<em>iterable</em>) – Iterable of tuples where column
labelcol contains a sample label that is used for stratification</li>
<li><strong>labelcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Column of tuple/samples that contains the label,</li>
<li><strong>labeldist</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – Dictionary with numbers of different labels,
e.g. {‘good’:12, ‘bad’:27, ‘ugly’:3}</li>
<li><strong>rand</strong> (<em>Random|None</em>) – Random number generator used for down-sampling.
If None, random.Random() is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Stratified samples</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Generator over tuples</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.stratify.Stratify.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.stratify.Stratify.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nutsml.transformer">
<span id="nutsml-transformer-module"></span><h2>nutsml.transformer module<a class="headerlink" href="#module-nutsml.transformer" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-transformer"></span><dl class="class">
<dt id="nutsml.transformer.AugmentImage">
<em class="property">class </em><code class="descname">AugmentImage</code><span class="sig-paren">(</span><em>imagecols</em>, <em>rand=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#AugmentImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.AugmentImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.Nut</span></code></p>
<p>Random augmentation of images in samples</p>
<dl class="method">
<dt id="nutsml.transformer.AugmentImage.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>imagecols</em>, <em>rand=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#AugmentImage.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.AugmentImage.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>samples &gt;&gt; AugmentImage(imagecols, rand=None)</p>
<p>Randomly augment images, e.g. changing contrast. See TransformImage for
a full list of available augmentations. Every transformation can be
used as an augmentation. Note that the same (random) augmentation
is applied to all images specified in imagecols. This ensures that
an image and its mask are randomly rotated by the same angle,
for instance.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augment_img</span> <span class="o">=</span> <span class="p">(</span><span class="n">AugmentImage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;identical&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">])</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;contrast&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">])</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;fliplr&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;flipud&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;occlude&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;rotate&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">]))</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#nutsml.transformer.TransformImage.by" title="nutsml.transformer.TransformImage.by"><code class="xref py py-func docutils literal notranslate"><span class="pre">nutsml.transformer.TransformImage.by()</span></code></a> for full list of
available augmentations.</p>
<p>Note that each augmentation is applied independently. This is in
contrast to transformations which are applied in sequence and
result in one image.
Augmentation on the other hand are randomly applied and can result
in many images. However, augmenters can be chained to achieve
combinations of augmentation, e.g. contrast or brightness combined with
rotation or shearing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augment1</span> <span class="o">=</span> <span class="p">(</span><span class="n">AugmentImage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;brightness&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">])</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;contrast&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augment2</span> <span class="o">=</span> <span class="p">(</span><span class="n">AugmentImage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;shear&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
<span class="gp">... </span>    <span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;rotate&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">augment1</span> <span class="o">&gt;&gt;</span> <span class="n">augment2</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>  
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>imagecols</strong> (<em>int|tuple</em>) – Indices of sample columns that contain
images.</li>
<li><strong>rand</strong> (<em>Random|None</em>) – Random number generator. If None,
random.Random() is used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.transformer.AugmentImage.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#AugmentImage.__rrshift__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.AugmentImage.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply augmentation to samples in iterable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>iterable</strong> (<em>iterable</em>) – Samples</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">iterable with augmented samples</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">generator</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.transformer.AugmentImage.by">
<code class="descname">by</code><span class="sig-paren">(</span><em>name</em>, <em>prob</em>, <em>*ranges</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#AugmentImage.by"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.AugmentImage.by" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify and add augmentation to be performed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">augment_img</span> <span class="o">=</span> <span class="n">AugmentImage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;rotate&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>string</em>) – Name of the augmentation/transformation, e.g.
‘rotate’</li>
<li><strong>prob</strong> (<em>float|int</em>) – If prob &lt;= 1:  probability [0,1] that the augmentation is applied
If prob &gt; 1: number of times augmentation is applied.</li>
<li><strong>of lists ranges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – <p>Lists with ranges for each argument of
the augmentation, e.g. [0, 360] degrees, where parameters are</p>
<blockquote>
<div>randomly sampled from.</div></blockquote>
</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Keyword arguments passed on the the augmentation.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">instance of AugmentImage</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#nutsml.transformer.AugmentImage" title="nutsml.transformer.AugmentImage">AugmentImage</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.transformer.ImageAnnotationToMask">
<em class="property">class </em><code class="descname">ImageAnnotationToMask</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#ImageAnnotationToMask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.ImageAnnotationToMask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.Nut</span></code></p>
<p>samples &gt;&gt; ImageAnnotationToMask(imagecol, annocol)</p>
<p>Create mask for image annotation. Annotation are of the following formats.
See imageutil.annotation2coords for details.
(‘point’, ((x, y), … ))
(‘circle’, ((x, y, r), …))
(‘rect’, ((x, y, w, h), …))
(‘polyline’, (((x, y), (x, y), …), …))</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Collect</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">anno</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;point&#39;</span><span class="p">,</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">img</span><span class="p">,</span> <span class="n">anno</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masks</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">ImageAnnotationToMask</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">masks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[[  0   0 255]</span>
<span class="go"> [255   0   0]</span>
<span class="go"> [  0   0   0]]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> (<em>iterable</em>) – Samples with images and annotations</li>
<li><strong>imagecol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of sample column that contain image</li>
<li><strong>annocol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of sample column that contain annotation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Iterator over samples where annotations are replaced by masks</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">generator</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.transformer.ImageAnnotationToMask.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.transformer.ImageAnnotationToMask.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.transformer.ImageChannelMean">
<em class="property">class </em><code class="descname">ImageChannelMean</code><span class="sig-paren">(</span><em>imagecol</em>, <em>filepath='image_channel_means.npy'</em>, <em>means=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#ImageChannelMean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.ImageChannelMean" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Compute, save per-channel means over images and subtract from images.</p>
<dl class="method">
<dt id="nutsml.transformer.ImageChannelMean.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#ImageChannelMean.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.ImageChannelMean.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract per-channel mean from images in samples.</p>
<p>sub_mean = ImageChannelMean(imagecol, filepath=’means.npy’)
samples &gt;&gt; sub_mean &gt;&gt; Consume()</p>
<p>sub_mean = ImageChannelMean(imagecol, means=[197, 87, 101])
samples &gt;&gt; sub_mean &gt;&gt; Consume()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sample</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Sample that contains an image (at imagecol).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Sample with image where mean is subtracted.
Note that image will not be of dtype uint8 and
in range [0,255] anymore!</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.transformer.ImageChannelMean.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>imagecol</em>, <em>filepath='image_channel_means.npy'</em>, <em>means=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#ImageChannelMean.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.ImageChannelMean.__init__" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><dl class="docutils">
<dt>samples &gt;&gt; ImageChannelMean(imagecol,</dt>
<dd>filepath=’image_channel_means.npy’,
means=None)</dd>
</dl>
<p>Construct ImageChannelMean nut.</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>imagecol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of sample column that contain image</li>
<li><strong>filepath</strong> (<em>string</em>) – Path to file were mean values are saved
and loaded from.</li>
<li><strong>means</strong> (<em>list|tuple</em>) – Mean values can be provided directly.
In this case filepath will be ignored and training is not
necessary.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.transformer.ImageChannelMean.train">
<code class="descname">train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#ImageChannelMean.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.ImageChannelMean.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute per-channel mean over images in samples.</p>
<p>sub_mean = ImageChannelMean(imagecol, filepath)
samples &gt;&gt; sub_mean.train() &gt;&gt; Consume()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Input samples are returned unchanged</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.transformer.ImageMean">
<em class="property">class </em><code class="descname">ImageMean</code><span class="sig-paren">(</span><em>imagecol</em>, <em>filepath='image_means.npy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#ImageMean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.ImageMean" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Compute, save mean over images and subtract from images.</p>
<dl class="method">
<dt id="nutsml.transformer.ImageMean.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#ImageMean.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.ImageMean.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract mean from images in samples.</p>
<p>sub_mean = ImageMean(imagecol, filepath)
samples &gt;&gt; sub_mean &gt;&gt; Consume()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sample</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Sample that contains an image (at imagecol).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Sample with image where mean is subtracted.
Note that image will not be of dtype uint8 and
in range [0,255] anymore!</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.transformer.ImageMean.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>imagecol</em>, <em>filepath='image_means.npy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#ImageMean.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.ImageMean.__init__" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>samples &gt;&gt; ImageMean(imagecol, filepath=’image_means.npy’)</p>
<p>Construct ImageMean nut.</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>imagecol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of sample column that contain image</li>
<li><strong>filepath</strong> (<em>string</em>) – Path to file were mean values are saved
and loaded from.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.transformer.ImageMean.train">
<code class="descname">train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#ImageMean.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.ImageMean.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute mean over images in samples.</p>
<p>sub_mean = ImageMean(imagecol, filepath)
samples &gt;&gt; sub_mean.train() &gt;&gt; Consume()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Input samples are returned unchanged</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.transformer.ImagePatchesByAnnotation">
<em class="property">class </em><code class="descname">ImagePatchesByAnnotation</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#ImagePatchesByAnnotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.ImagePatchesByAnnotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.Nut</span></code></p>
<dl class="docutils">
<dt>samples &gt;&gt; ImagePatchesByAnnotation(imagecol, annocol, pshape, npos,</dt>
<dd>nneg=lambda npos: npos,
pos=255, neg=0, retlabel=True)</dd>
</dl>
<p>Randomly sample positive/negative patches from image based on annotation.
See imageutil.annotation2coords for annotation format.
A patch is positive if its center point is within the annotated region
and is negative otherwise.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="c1"># just to ensure stable doctest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">anno</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;point&#39;</span><span class="p">,</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">img</span><span class="p">,</span> <span class="n">anno</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">getpatches</span> <span class="o">=</span> <span class="n">ImagePatchesByAnnotation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">getpatches</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">l</span><span class="p">)</span>
<span class="go">[[12, 13, 14], [17, 18, 19], [22, 23, 24]] 0</span>
<span class="go">[[11, 12, 13], [16, 17, 18], [21, 22, 23]] 1</span>
<span class="go">[[7, 8, 9], [12, 13, 14], [17, 18, 19]] 1</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> (<em>iterable</em>) – Samples with images</li>
<li><strong>imagecol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of sample column that contain image</li>
<li><strong>annocol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of sample column that contain annotation</li>
<li><strong>pshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Shape of patch</li>
<li><strong>npos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of positive patches to sample</li>
<li><strong>nneg</strong> (<em>int|function</em>) – Number of negative patches to sample or
a function hat returns the number of negatives
based on number of positives.</li>
<li><strong>pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Mask value indicating positives</li>
<li><strong>neg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Mask value indicating negatives</li>
<li><strong>retlabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True return label, False return mask patch</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Iterator over samples where images are replaced by image patches
and masks are replaced by labels [0,1] or mask patches</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">generator</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.transformer.ImagePatchesByAnnotation.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.transformer.ImagePatchesByAnnotation.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.transformer.ImagePatchesByMask">
<em class="property">class </em><code class="descname">ImagePatchesByMask</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#ImagePatchesByMask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.ImagePatchesByMask" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.Nut</span></code></p>
<dl class="docutils">
<dt>samples &gt;&gt; ImagePatchesByMask(imagecol, maskcol, pshape, npos,</dt>
<dd>nneg=lambda npos: npos,
pos=255, neg=0, retlabel=True)</dd>
</dl>
<p>Randomly sample positive/negative patches from image based on mask.</p>
<p>A patch is positive if its center point has the value ‘pos’ in the
mask (corresponding to the input image) and is negative for value ‘neg’
The mask must be of same size as image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="c1"># just to ensure stable doctest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="mi">255</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">img</span><span class="p">,</span> <span class="n">mask</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">getpatches</span> <span class="o">=</span> <span class="n">ImagePatchesByMask</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">getpatches</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">l</span><span class="p">)</span>
<span class="go">[[10, 11, 12], [15, 16, 17], [20, 21, 22]] 0</span>
<span class="go">[[12, 13, 14], [17, 18, 19], [22, 23, 24]] 1</span>
<span class="go">[[6, 7, 8], [11, 12, 13], [16, 17, 18]] 1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="c1"># just to ensure stable doctest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">patches</span> <span class="o">=</span> <span class="n">ImagePatchesByMask</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">retlabel</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="ow">in</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">getpatches</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">l</span><span class="p">)</span>
<span class="go">[[10, 11, 12], [15, 16, 17], [20, 21, 22]] 1</span>
<span class="go">[[12, 13, 14], [17, 18, 19], [22, 23, 24]] 1</span>
<span class="go">[[6, 7, 8], [11, 12, 13], [16, 17, 18]] 1</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> (<em>iterable</em>) – Samples with images</li>
<li><strong>imagecol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of sample column that contain image</li>
<li><strong>maskcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of sample column that contain mask</li>
<li><strong>pshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Shape of patch</li>
<li><strong>npos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of positive patches to sample</li>
<li><strong>nneg</strong> (<em>int|function</em>) – Number of negative patches to sample or
a function hat returns the number of negatives
based on number of positives.</li>
<li><strong>pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Mask value indicating positives</li>
<li><strong>neg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Mask value indicating negatives</li>
<li><strong>retlabel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – True return label, False return mask patch</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Iterator over samples where images are replaced by image patches
and masks are replaced by labels [0,1] or mask patches</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">generator</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.transformer.ImagePatchesByMask.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.transformer.ImagePatchesByMask.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.transformer.RandomImagePatches">
<em class="property">class </em><code class="descname">RandomImagePatches</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#RandomImagePatches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.RandomImagePatches" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.Nut</span></code></p>
<p>samples &gt;&gt; RandomImagePatches(imagecols, shape, npatches)</p>
<p>Extract patches at random locations from images.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="c1"># just to ensure stable doctest</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">img</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getpatches</span> <span class="o">=</span> <span class="n">RandomImagePatches</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">getpatches</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">l</span><span class="p">)</span>
<span class="go">[[7, 8, 9], [13, 14, 15]] 0</span>
<span class="go">[[8, 9, 10], [14, 15, 16]] 0</span>
<span class="go">[[8, 9, 10], [14, 15, 16]] 0</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> (<em>iterable</em>) – Samples with images</li>
<li><strong>imagecols</strong> (<em>int|tuple</em>) – Indices of sample columns that contain
images, where patches are extracted from.
Images must be numpy arrays of shape h,w,c or h,w</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Shape of patch (h,w)</li>
<li><strong>npatches</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of patches to extract (per image)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Iterator over samples where images are replaced by patches.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">generator</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.transformer.RandomImagePatches.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.transformer.RandomImagePatches.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.transformer.RegularImagePatches">
<em class="property">class </em><code class="descname">RegularImagePatches</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#RegularImagePatches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.RegularImagePatches" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.Nut</span></code></p>
<p>samples &gt;&gt; RegularImagePatches(imagecols, shape, stride)</p>
<p>Extract patches in a regular grid from images.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="n">img</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getpatches</span> <span class="o">=</span> <span class="n">RegularImagePatches</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">getpatches</span><span class="p">:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">(array([[0, 1],</span>
<span class="go">       [4, 5]]), 0)</span>
<span class="go">(array([[2, 3],</span>
<span class="go">       [6, 7]]), 0)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>iterable</strong> (<em>iterable</em>) – Samples with images</li>
<li><strong>imagecols</strong> (<em>int|tuple</em>) – Indices of sample columns that contain
images, where patches are extracted from.
Images must be numpy arrays of shape h,w,c or h,w</li>
<li><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Shape of patch (h,w)</li>
<li><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Step size of grid patches are extracted from</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Iterator over samples where images are replaced by patches.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">generator</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nutsml.transformer.RegularImagePatches.__rrshift__">
<code class="descname">__rrshift__</code><span class="sig-paren">(</span><em>iterable</em><span class="sig-paren">)</span><a class="headerlink" href="#nutsml.transformer.RegularImagePatches.__rrshift__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.transformer.TransformImage">
<em class="property">class </em><code class="descname">TransformImage</code><span class="sig-paren">(</span><em>imagecols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#TransformImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.TransformImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Transformation of images in samples.</p>
<dl class="method">
<dt id="nutsml.transformer.TransformImage.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#TransformImage.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.TransformImage.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply transformation to sample.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sample</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Sample</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Transformed sample</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.transformer.TransformImage.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>imagecols</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#TransformImage.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.TransformImage.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>samples &gt;&gt; TransformImage(imagecols)</p>
<p>Images are expected to be numpy arrays of the shape (h, w, c) or (h, w)
with a range of [0,255] and a dtype of uint8. Transformation should
result in images with the same properties.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">TransformImage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;resize&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>imagecols</strong> (<em>int|tuple</em>) – Indices of sample columns the transformation
should be applied to. Can be a single index or a tuple of indices.</li>
<li><strong>transspec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Transformation specification. Either a
tuple with the name of the transformation function or a tuple
with the name, arguments and keyword arguments of the
transformation function.
The list of argument values and dictionaries provided in the
transspec are simply passed on to the transformation function.
See the relevant functions for details.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.transformer.TransformImage.by">
<code class="descname">by</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#TransformImage.by"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.TransformImage.by" title="Permalink to this definition">¶</a></dt>
<dd><p>Specify and add transformations to be performed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">TransformImage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;resize&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;fliplr&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Available transformations:</div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.identical" title="nutsml.imageutil.identical"><code class="xref py py-func docutils literal notranslate"><span class="pre">identical</span></code></a></div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.rerange" title="nutsml.imageutil.rerange"><code class="xref py py-func docutils literal notranslate"><span class="pre">rerange</span></code></a>
(old_min, old_max, new_min, new_max, dtype)</div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.crop" title="nutsml.imageutil.crop"><code class="xref py py-func docutils literal notranslate"><span class="pre">crop</span></code></a> (x1, y1, x2, y2)</div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.crop_center" title="nutsml.imageutil.crop_center"><code class="xref py py-func docutils literal notranslate"><span class="pre">crop_center</span></code></a>  (w, h)</div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.crop_square" title="nutsml.imageutil.crop_square"><code class="xref py py-func docutils literal notranslate"><span class="pre">crop_square</span></code></a></div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.normalize_histo" title="nutsml.imageutil.normalize_histo"><code class="xref py py-func docutils literal notranslate"><span class="pre">normalize_histo</span></code></a>  (gamma)</div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.rgb2gray" title="nutsml.imageutil.rgb2gray"><code class="xref py py-func docutils literal notranslate"><span class="pre">rgb2gray</span></code></a></div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.gray2rgb" title="nutsml.imageutil.gray2rgb"><code class="xref py py-func docutils literal notranslate"><span class="pre">gray2rgb</span></code></a></div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.resize" title="nutsml.imageutil.resize"><code class="xref py py-func docutils literal notranslate"><span class="pre">resize</span></code></a>  (w, h)</div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.translate" title="nutsml.imageutil.translate"><code class="xref py py-func docutils literal notranslate"><span class="pre">translate</span></code></a> (dx, dy)</div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.rotate" title="nutsml.imageutil.rotate"><code class="xref py py-func docutils literal notranslate"><span class="pre">rotate</span></code></a> (angle)</div>
<div class="line"><code class="xref py py-func docutils literal notranslate"><span class="pre">contrast</span></code> (contrast)</div>
<div class="line"><code class="xref py py-func docutils literal notranslate"><span class="pre">sharpness</span></code> (sharpness)</div>
<div class="line"><code class="xref py py-func docutils literal notranslate"><span class="pre">brightness</span></code> (brightness)</div>
<div class="line"><code class="xref py py-func docutils literal notranslate"><span class="pre">color</span></code> (color)</div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.fliplr" title="nutsml.imageutil.fliplr"><code class="xref py py-func docutils literal notranslate"><span class="pre">fliplr</span></code></a></div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.flipud" title="nutsml.imageutil.flipud"><code class="xref py py-func docutils literal notranslate"><span class="pre">flipud</span></code></a></div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.shear" title="nutsml.imageutil.shear"><code class="xref py py-func docutils literal notranslate"><span class="pre">shear</span></code></a> (shear_factor)</div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.distort_elastic" title="nutsml.imageutil.distort_elastic"><code class="xref py py-func docutils literal notranslate"><span class="pre">elastic</span></code></a> (smooth, scale, seed)</div>
<div class="line"><a class="reference internal" href="#nutsml.imageutil.occlude" title="nutsml.imageutil.occlude"><code class="xref py py-func docutils literal notranslate"><span class="pre">occlude</span></code></a> (x, y, w, h)</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>string</em>) – Name of the transformation to apply, e.g. ‘resize’</li>
<li><strong>args</strong> (<em>args</em>) – Arguments for the transformation, e.g. width and
height for resize.</li>
<li><strong>kwargs</strong> (<em>kwargs</em>) – Keyword arguments passed on to the transformation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">instance of TransformImage with added transformation</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#nutsml.transformer.TransformImage" title="nutsml.transformer.TransformImage">TransformImage</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="nutsml.transformer.TransformImage.register">
<em class="property">classmethod </em><code class="descname">register</code><span class="sig-paren">(</span><em>name</em>, <em>transformation</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#TransformImage.register"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.TransformImage.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Register new transformation function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">brighter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">image</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="n">image</span> <span class="o">*</span> <span class="n">c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TransformImage</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s1">&#39;brighter&#39;</span><span class="p">,</span> <span class="n">brighter</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">TransformImage</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">by</span><span class="p">(</span><span class="s1">&#39;brighter&#39;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>string</em>) – Name of transformation</li>
<li><strong>transformation</strong> (<em>function</em>) – Transformation function.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="nutsml.transformer.TransformImage.transformations">
<code class="descname">transformations</code><em class="property"> = {'brightness': &lt;function change_brightness at 0x0000000009332510&gt;, 'color': &lt;function change_color at 0x0000000009332620&gt;, 'contrast': &lt;function change_contrast at 0x0000000009332488&gt;, 'crop': &lt;function crop at 0x0000000009332158&gt;, 'crop_center': &lt;function crop_center at 0x00000000093321E0&gt;, 'crop_square': &lt;function crop_square at 0x0000000009332268&gt;, 'elastic': &lt;function distort_elastic at 0x0000000009332AE8&gt;, 'fliplr': &lt;function fliplr at 0x00000000093329D8&gt;, 'flipud': &lt;function flipud at 0x0000000009332A60&gt;, 'gray2rgb': &lt;function gray2rgb at 0x00000000093326A8&gt;, 'identical': &lt;function identical at 0x00000000093320D0&gt;, 'normalize_histo': &lt;function normalize_histo at 0x0000000009332378&gt;, 'occlude': &lt;function occlude at 0x00000000093322F0&gt;, 'rerange': &lt;function rerange at 0x0000000009332048&gt;, 'resize': &lt;function resize at 0x00000000093328C8&gt;, 'rgb2gray': &lt;function rgb2gray at 0x0000000009332730&gt;, 'rotate': &lt;function rotate at 0x0000000009332840&gt;, 'sharpness': &lt;function change_sharpness at 0x0000000009332598&gt;, 'shear': &lt;function shear at 0x0000000009332950&gt;, 'translate': &lt;function translate at 0x00000000093327B8&gt;}</em><a class="headerlink" href="#nutsml.transformer.TransformImage.transformations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="nutsml.transformer.map_transform">
<code class="descname">map_transform</code><span class="sig-paren">(</span><em>sample</em>, <em>imagecols</em>, <em>spec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/transformer.html#map_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.transformer.map_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Map transformation function on columns of sample.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sample</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Sample with images</li>
<li><strong>imagecols</strong> (<em>int|tuple</em>) – Indices of sample columns the transformation
should be applied to. Can be a single index or a tuple of indices.</li>
<li><strong>spec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Transformation specification. Either a tuple with
the name of the transformation function or a tuple with the
name, arguments and keyword arguments of the transformation function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Sample with transformations applied. Columns not specified
remain unchained.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-nutsml.viewer">
<span id="nutsml-viewer-module"></span><h2>nutsml.viewer module<a class="headerlink" href="#module-nutsml.viewer" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-viewer"></span><dl class="class">
<dt id="nutsml.viewer.PrintColType">
<em class="property">class </em><code class="descname">PrintColType</code><span class="sig-paren">(</span><em>cols=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/viewer.html#PrintColType"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.viewer.PrintColType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<dl class="method">
<dt id="nutsml.viewer.PrintColType.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/viewer.html#PrintColType.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.viewer.PrintColType.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Print data info.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>any</em>) – Any type of iterable</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">data unchanged</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">same as data</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.viewer.PrintColType.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>cols=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/viewer.html#PrintColType.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.viewer.PrintColType.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>iterable &gt;&gt; PrintColType()</p>
<p>Print type and other information for columns in data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Consume</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">&gt;&gt;</span> <span class="n">PrintColType</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
<span class="go">item 0: &lt;tuple&gt;</span>
<span class="go">  0: &lt;ndarray&gt; shape:10x20x3 dtype:float64 range:0.0..0.0</span>
<span class="go">  1: &lt;int&gt; 1</span>
<span class="go">item 1: &lt;tuple&gt;</span>
<span class="go">  0: &lt;str&gt; text</span>
<span class="go">  1: &lt;int&gt; 2</span>
<span class="go">item 2: &lt;int&gt;</span>
<span class="go">  0: &lt;int&gt; 3</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span> <span class="o">&gt;&gt;</span> <span class="n">PrintColType</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
<span class="go">item 0: &lt;tuple&gt;</span>
<span class="go">  1: &lt;int&gt; 2</span>
<span class="go">item 1: &lt;tuple&gt;</span>
<span class="go">  1: &lt;int&gt; 4</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cols</strong> (<em>int|tuple|None</em>) – Indices of columnbs to show info for.
None means all columns. Can be a single index or a tuple of indices.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">input data unchanged</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">same as data</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.viewer.ViewImage">
<em class="property">class </em><code class="descname">ViewImage</code><span class="sig-paren">(</span><em>imgcols</em>, <em>layout=(1</em>, <em>None)</em>, <em>figsize=None</em>, <em>pause=0.0001</em>, <em>**imargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/viewer.html#ViewImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.viewer.ViewImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Display images in window.</p>
<dl class="method">
<dt id="nutsml.viewer.ViewImage.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/viewer.html#ViewImage.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.viewer.ViewImage.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>View the images in data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Data with images at imgcols.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">unchanged input data</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.viewer.ViewImage.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>imgcols</em>, <em>layout=(1</em>, <em>None)</em>, <em>figsize=None</em>, <em>pause=0.0001</em>, <em>**imargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/viewer.html#ViewImage.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.viewer.ViewImage.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>iterable &gt;&gt; ViewImage(imgcols, layout=(1, None), figsize=None, <a href="#id9"><span class="problematic" id="id10">**</span></a>plotargs)</p>
<div class="line-block">
<div class="line">Images should be numpy arrays in one of the following formats:</div>
<div class="line">MxN - luminance (grayscale, float array only)</div>
<div class="line">MxNx3 - RGB (float or uint8 array)</div>
<div class="line">MxNx4 - RGBA (float or uint8 array)</div>
</div>
<p>Shapes with single-dimension axis are supported but not encouraged,
e.g. MxNx1 will be converted to MxN.</p>
<p>See
<a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow">http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Consume</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsml</span> <span class="k">import</span> <span class="n">ReadImage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imagepath</span> <span class="o">=</span> <span class="s1">&#39;tests/data/img_formats/*.jpg&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;nut_color&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;nut_grayscale&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">read_image</span> <span class="o">=</span> <span class="n">ReadImage</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">imagepath</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">read_image</span> <span class="o">&gt;&gt;</span> <span class="n">ViewImage</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span> 
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>imgcols</strong> (<em>int|tuple|None</em>) – Index or tuple of indices of data columns
containing images (ndarray). Use None if images are provided
directly, e.g. [img1, img2, …] &gt;&gt; ViewImage(None) &gt;&gt; Consume()</li>
<li><strong>layout</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Rows and columns of the viewer layout., e.g.
a layout of (2,3) means that 6 images in the data are
arranged in 2 rows and 3 columns.
Number of cols can be None is then derived from imgcols</li>
<li><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Figure size in inch.</li>
<li><strong>pause</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Waiting time in seconds after each plot.
Pressing a key skips the waiting time.</li>
<li><strong>imargs</strong> (<em>kwargs</em>) – Keyword arguments passed on to matplotlib’s
imshow() function. See
<a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow">http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nutsml.viewer.ViewImageAnnotation">
<em class="property">class </em><code class="descname">ViewImageAnnotation</code><span class="sig-paren">(</span><em>imgcol</em>, <em>annocols</em>, <em>figsize=None</em>, <em>pause=0.0001</em>, <em>interpolation=None</em>, <em>**annoargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/viewer.html#ViewImageAnnotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.viewer.ViewImageAnnotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Display images and annotation in window.</p>
<dl class="attribute">
<dt id="nutsml.viewer.ViewImageAnnotation.SHAPEPROP">
<code class="descname">SHAPEPROP</code><em class="property"> = {'edgecolor': 'y', 'facecolor': 'none', 'linewidth': 1}</em><a class="headerlink" href="#nutsml.viewer.ViewImageAnnotation.SHAPEPROP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="nutsml.viewer.ViewImageAnnotation.TEXTPROP">
<code class="descname">TEXTPROP</code><em class="property"> = {'backgroundcolor': (1, 1, 1, 0.5), 'edgecolor': 'k'}</em><a class="headerlink" href="#nutsml.viewer.ViewImageAnnotation.TEXTPROP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nutsml.viewer.ViewImageAnnotation.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/viewer.html#ViewImageAnnotation.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.viewer.ViewImageAnnotation.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>View the image and its annotation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Data with image at imgcol and annotation at annocol.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">unchanged input data</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nutsml.viewer.ViewImageAnnotation.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>imgcol</em>, <em>annocols</em>, <em>figsize=None</em>, <em>pause=0.0001</em>, <em>interpolation=None</em>, <em>**annoargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/viewer.html#ViewImageAnnotation.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.viewer.ViewImageAnnotation.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>iterable &gt;&gt; ViewImageAnnotation(imgcol, annocols, figsize=None,</dt>
<dd>pause, interpolation, <a href="#id11"><span class="problematic" id="id12">**</span></a>annoargs)</dd>
</dl>
<div class="line-block">
<div class="line">Images must be numpy arrays in one of the following formats:</div>
<div class="line">MxN - luminance (grayscale, float array only)</div>
<div class="line">MxNx3 - RGB (float or uint8 array)</div>
<div class="line">MxNx4 - RGBA (float or uint8 array)</div>
<div class="line">See</div>
<div class="line"><a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow">http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow</a></div>
</div>
<p>Shapes with single-dimension axis are supported but not encouraged,
e.g. MxNx1 will be converted to MxN.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>imgcol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of data column that contains the image</li>
<li><strong>annocols</strong> (<em>int|tuple</em>) – Index or tuple of indices specifying the data
column(s) that contain annotation (labels, or geometry)</li>
<li><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Figure size in inch.</li>
<li><strong>pause</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Waiting time in seconds after each plot.
Pressing a key skips the waiting time.</li>
<li><strong>interpolation</strong> (<em>string</em>) – Interpolation for imshow, e.g.
‘nearest’, ‘bilinear’, ‘bicubic’. for details see
<a class="reference external" href="http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow">http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.imshow</a></li>
<li><strong>annoargs</strong> (<em>kwargs</em>) – Keyword arguments for visual properties of
annotation, e.g.  edgecolor=’y’, linewidth=1</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nutsml.writer">
<span id="nutsml-writer-module"></span><h2>nutsml.writer module<a class="headerlink" href="#module-nutsml.writer" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-writer"></span><dl class="class">
<dt id="nutsml.writer.WriteImage">
<em class="property">class </em><code class="descname">WriteImage</code><span class="sig-paren">(</span><em>column</em>, <em>pathfunc</em>, <em>namefunc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/writer.html#WriteImage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.writer.WriteImage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">nutsflow.base.NutFunction</span></code></p>
<p>Write images within samples.</p>
<dl class="method">
<dt id="nutsml.writer.WriteImage.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>sample</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/writer.html#WriteImage.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.writer.WriteImage.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return sample and write image within sample</p>
</dd></dl>

<dl class="method">
<dt id="nutsml.writer.WriteImage.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>column</em>, <em>pathfunc</em>, <em>namefunc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/nutsml/writer.html#WriteImage.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#nutsml.writer.WriteImage.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Write images within samples to file.</p>
<p>Writes jpg, gif, png, tif and bmp format depending on file extension.
Images in samples are expected to be numpy arrays.
See nutsml.util.load_image for details.</p>
<p>Folders on output file path are created if missing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsml</span> <span class="k">import</span> <span class="n">ReadImage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">nutsflow</span> <span class="k">import</span> <span class="n">Collect</span><span class="p">,</span> <span class="n">Get</span><span class="p">,</span> <span class="n">GetCols</span><span class="p">,</span> <span class="n">Consume</span><span class="p">,</span> <span class="n">Unzip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;nut_color&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;nut_grayscale&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inpath</span> <span class="o">=</span> <span class="s1">&#39;tests/data/img_formats/*.bmp&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_samples</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">ReadImage</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inpath</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">imagepath</span> <span class="o">=</span> <span class="s1">&#39;tests/data/test_*.bmp&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_samples</span> <span class="o">&gt;&gt;</span> <span class="n">WriteImage</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">imagepath</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">imagepath</span> <span class="o">=</span> <span class="s1">&#39;tests/data/test_*.bmp&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images</span> <span class="o">=</span> <span class="n">img_samples</span> <span class="o">&gt;&gt;</span> <span class="n">Get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">images</span> <span class="o">&gt;&gt;</span> <span class="n">WriteImage</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">imagepath</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">imagepath</span> <span class="o">=</span> <span class="s1">&#39;tests/data/test_*.bmp&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">namefunc</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sample</span><span class="p">:</span> <span class="n">sample</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">samples</span> <span class="o">&gt;&gt;</span> <span class="n">GetCols</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">ReadImage</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inpath</span><span class="p">)</span> <span class="o">&gt;&gt;</span>
<span class="gp">... </span><span class="n">WriteImage</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">imagepath</span><span class="p">,</span> <span class="n">namefunc</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="n">Consume</span><span class="p">())</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>column</strong> (<em>int|None</em>) – Column in sample that contains image or
take sample itself if column is None.</li>
<li><strong>pathfunc</strong> (<em>str|function</em>) – Filepath with wildcard ‘*’,
which is replaced by the name provided names e.g.
‘tests/data/img_formats/<a href="#id13"><span class="problematic" id="id14">*</span></a>.jpg’ for names = [‘nut_grayscale’]
will become ‘tests/data/img_formats/nut_grayscale.jpg’
or
Function to compute path to image file from sample and name, e.g.
pathfunc=lambda sample, name: ‘tests/data/test_{}.jpg’.format(name)</li>
<li><strong>namefunc</strong> (<em>iterable|function|None</em>) – Iterable over names to generate
image paths from (length need to be the same as samples),
or
Function to compute filenames from sample, e.g.
namefunc=lambda samples: sample[0]
if None, Enumerate() is used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-nutsml">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-nutsml" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="nutsml.examples.html" class="btn btn-neutral float-right" title="nutsml.examples package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="contributions.html" class="btn btn-neutral" title="Contributions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, IBM Research Australia.
      Last updated on Oct 04, 2018.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.38',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>